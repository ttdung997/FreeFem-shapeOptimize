-- FreeFem++ v4.700001 (Sat Oct 17 12:48:33 CEST 2020 - git v4.7-64-g08041365)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue 
    1 : ////////////////////////////////////////////////
    2 : // Compliance Optimization                    //
    3 : // by the boundary variation method           //
    4 : // Copyright O.Pantz, G. Allaire (2005)       //
    5 : ////////////////////////////////////////////////
    6 : 
    7 : // Optimization Parameters 
    8 : int niter=60;			//Number of iterations
    9 : real errelas=0.01;		//Error for the resolution of the variational problems
   10 : real metricmsh=5.;		//Metric used for the coarse mesh: Bigger=finer mesh
   11 : real initialstep=0.2;		//Initial step
   12 : real maxstep=-1.;		//Maximum step (<0 => no limit)
   13 : real lagrangestep=3.;		//Updating step of the Lagrange multiplier associated to the Volume's constraint
   14 : bool tocontinue=false;		//false=start a new computation, true=continue a previous computation
   15 : string backupname="output";	//Name under which the results are stored
   16 : int nsave=1;			//Number of iterations to be saved
   17 : real volume0=95.;		//=0 Constant Volume during the iterations, >0 Target Volume, <0 No Volume's constraint
   18 : 
   19 : int np =10;
   20 : // construction of the initial mesh
   21 : 	mesh Sh,Th,Shprev,Thprev;
   22 : 	//Definition of the boundary labels
   23 : 	int neumann=1; int dirichlet=2;
   24 : 	int free=3;
   25 : 
   26 : 
   27 : 	int WALL = 1;
   28 : 	int LOAD = 2;
   29 : 	int FREE = 3;
   30 : //this is case 1
   31 : 	
   32 :  // border L11(t = 0.0, 0.5){x = t; y = 0.0; label = FREE;}
   33 :  //    border L21(t = 0.0, 0.45){x = 0.5; y = t; label = FREE;}
   34 :  //    border L22(t = 0.45, 0.55){x = 0.5; y = t; label = LOAD;}
   35 :  //    border L23(t = 0.55, 1.0){x = 0.5; y = t; label = FREE;}
   36 :  //    border L31(t = 0.5, 0){x = t; y = 1.0; label = FREE;}
   37 :  //    border L41(t = 1.0, 0.9){x = 0.0; y = t; label = WALL;}
   38 :  //    border L42(t = 0.9, 0.1){x = 0.0; y = t; label = FREE;}
   39 :  //    border L43(t = 0.1, 0.0){x = 0.0; y = t; label = WALL;}
   40 : 
   41 :  //    Sh = buildmesh(L11(5 * np) + L21(5 * np) + L22(1 * np) + L23(5 * np) + L31(5 * np) + L41(1 * np) + L42(8 * np) + L43(1 * np));
   42 : 
   43 : 
   44 : //this is case 2
   45 : 
   46 : 	// real r = 0.15;                                                                    
   47 : 
   48 :  //    border L11(t = -1.0, 1.0){x = t; y = 0.0; label = FREE;}
   49 :  //    border L21(t = 0.0, 0.45){x = 1.0; y = t; label = FREE;}
   50 :  //    border L22(t = 0.45, 0.55){x = 1.0; y = t; label = LOAD;}
   51 :  //    border L23(t = 0.55, 1.0){x = 1.0; y = t; label = FREE;}
   52 :  //    border L31(t = 1.0, -1.0){x = t; y = 1.0; label = FREE;}
   53 :  //    border L41(t = 1.0, 0.9){x = -1.0; y = t; label = WALL;}
   54 :  //    border L42(t = 0.9, 0.1){x = -1.0; y = t; label = FREE;}
   55 :  //    border L43(t = 0.1, 0.0){x = -1.0; y = t; label = WALL;}
   56 : 
   57 :     
   58 :  //    border C11(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.22 + r * sin(t); label = FREE;}
   59 :  //    border C12(t = 0, 2 * pi){x = 0.2 + r * cos(t); y = 0.22 + r * sin(t); label = FREE;}
   60 :  //    border C21(t = 0, 2 * pi){x = -0.2 + r * cos(t); y = 0.5 + r * sin(t); label = FREE;}
   61 :  //    border C22(t = 0, 2 * pi){x = 0.6 + r * cos(t); y = 0.5 + r * sin(t); label = FREE;}
   62 :  //    border C31(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.78 + r * sin(t); label = FREE;}
   63 :  //    border C32(t = 0, 2 * pi){x = 0.2 + r * cos(t); y = 0.78 + r * sin(t); label = FREE;}
   64 : 
   65 :  //    Sh = buildmesh(L11(20 * np) + L21(5 * np) + L22(1 * np) + L23(5 * np) + L31(20 * np) + L41(1 * np) + L42(8 * np) + L43(1 * np)
   66 :  //                    + C11(-10 * np) + C12(-10 * np)  + C21(-10 * np) + C22(-10 * np) + C31(-10 * np) + C32(-10 * np));
   67 : 
   68 : 
   69 : //this is case 3
   70 : 
   71 : 	 // real r = 0.2;                                                 
   72 : 
   73 :   //   border L11(t = 0.0, 1.0){x = t; y = 0.0; label = FREE;}
   74 :   //   border L21(t = 0.0, 0.2){x = 1.0; y = t; label = LOAD;}
   75 :   //   border L22(t = 0.2, 0.8){x = 1.0; y = t; label = FREE;}
   76 :   //   border L23(t = 0.8, 1.0){x = 1.0; y = t; label = LOAD;}
   77 :   //   border L31(t = 1.0, 0.0){x = t; y = 1.0; label = FREE;}
   78 :   //   border L41(t = 1.0, 0.95){x = 0.0; y = t; label = WALL;}
   79 :   //   border L42(t = 0.95, 0.05){x = 0.0; y = t; label = FREE;}
   80 :   //   border L43(t = 0.05, 0.0){x = 0.0; y = t; label = WALL;}
   81 : 
   82 :     
   83 :   //   border C11(t = 0, 2 * pi){x = 0.5 + r * cos(t); y = 0.25 + r * sin(t); label = FREE;}
   84 :   //   border C31(t = 0, 2 * pi){x = 0.5 + r * cos(t); y = 0.75 + r * sin(t); label = FREE;}
   85 : 
   86 :   //   Sh = buildmesh(L11(10 * np) + L21(2 * np) + L22(6 * np) + L23(2 * np) + L31(10 * np) + L41(1 * np) + L42(9 * np) + L43(1 * np)
   87 :   //       + C11(-15 * np) + C31(-15 * np)
   88 :   //       );
   89 : 
   90 : 
   91 : //this is case 4:
   92 : 
   93 : 	 // real r = 0.25;
   94 : 
   95 :   //   border L11(t = -1.0, -0.9){x = t; y = 0; label = FREE;}
   96 :   //   border L12(t = -0.9, -0.2){x = t; y = 0; label = FREE;}
   97 :   //   border L13(t = -0.2, 0.2){x = t; y = 0; label = FREE;}
   98 :   //   border L14(t = 0.2, 0.9){x = t; y = 0; label = FREE;}
   99 :   //   border L15(t = 0.9, 1.0){x = t; y = 0; label = FREE;}
  100 :     
  101 :   //   border L21(t = 0, 1.2){x = 1.0; y = t; label = FREE;}
  102 :   //   border L22(t = 1.0, -1.0){x = t; y = 1.2; label = FREE;}
  103 :   //   border L23(t = 1.2, 0){x = -1.0; y = t; label = FREE;}
  104 :     
  105 :   //   border C10(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.4 + r * sin(t); label = FREE;}
  106 :   //   border C11(t = 0, 2 * pi){x = r * cos(t); y = 0.8 + r * sin(t); label = FREE;}
  107 :   //   border C12(t = 0, 2 * pi){x = 0.6 + r * cos(t); y = 0.4 + r * sin(t); label = FREE;}
  108 : 
  109 :   //   Sh = buildmesh(L11(1 * np) + L12(7 * np) + L13(4 * np) + L14(7 * np) + L15(1 * np) + L21(12 * np) + L22(20 * np) + L23(12 * np) 
  110 :   //       + C10(-15 * np) + C11(-15 * np) + C12(-15 * np) 
  111 :   //       );
  112 : 
  113 : 
  114 : //this is case 5
  115 : real r = 0.05;
  116 : 
  117 :     border L11(t = 0.4, -0.4){x = t; y = 1.2; label = FREE;}
  118 :     border L21(t = 1.2, 0.8){x = -0.4; y = t; label = FREE;}
  119 :     border L31(t = -0.4, -0.35){x = t; y = 0.8; label = LOAD;}
  120 :     border L32(t = -0.35, -0.2){x = t; y = 0.8; label = FREE;}
  121 :     border L41(t = 0.8, 0.0){x = -0.2; y = t; label = FREE;}
  122 :     border L51(t = -0.2, -0.15){x = t; y = 0.0; label = WALL;}
  123 :     border L52(t = -0.15, 0.15){x = t; y = 0.0; label = FREE;}
  124 :     border L53(t = 0.15, 0.2){x = t; y = 0.0; label = WALL;}
  125 :     border L42(t = 0.0, 0.8){x = 0.2; y = t; label = FREE;}
  126 :     border L33(t = 0.2, 0.35){x = t; y = 0.8; label = FREE;}
  127 :     border L34(t = 0.35, 0.4){x = t; y = 0.8; label = LOAD;}
  128 :     border L22(t = 0.8, 1.2){x = 0.4; y = t; label = FREE;}
  129 : 
  130 :     border C1(t = 0, 2 * pi){x = -0.25 + r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  131 :     border C2(t = 0, 2 * pi){x = r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  132 :     border C3(t = 0, 2 * pi){x = 0.25 + r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  133 : 
  134 :     Sh = buildmesh(L11(8 * np) + L21(4 * np) + L31(1 * np) + L32(2 * np) + L41(8 * np) + L51(np) + L52(3 * np) + L53(1 * np) 
  135 :                     + L42(8 * np) + L33(2 * np) + L34(1 * np) + L22(4 * np) + C1(-7 * np) + C2(-7 * np) + C3(-7 * np));
  136 : 
  137 : 
  138 : 
  139 : // 	Th=Sh;
  140 : // 	Thprev=Th;
  141 : 
  142 : 	// cut function used to regularize the gradient shape near singularities
  143 : 	// func cut=1-(x>19.5)*(abs(y)<1.5)-(x<0.5)*(y>1.5)*(y<4.5)-(x<0.5)*(y<-1.5)*(y>-4.5);
  144 : 
  145 : 
  146 : 	func cut=(y < 0.8)*(abs(x) < 0.2) ;
  147 : 
  148 : // Material parameters
  149 : 	real E=15.;				//Young Modulus (always positif)
  150 : 	real nu=0.35;				//Poisson ratio (between -1 and 1/2)
  151 : 	real lambda=E*nu/((1.+nu)*(1.-2.*nu));	//Lame Moduli
  152 : 	real mu=E/(2.*(1.+nu));
  153 : 
  154 : //Applied Loads
  155 : 	func g1=0; func g2=50;
  156 : 
  157 : //Definition of the variables and intialization
  158 : 	//Finite elements spaces on the finer mesh Sh
  159 : 		fespace Wh(Sh,P1);  		
  160 : 		fespace WSh(Sh,[P2,P2]);
  161 : 	//Finite elements spaces on the coarse mesh Th
  162 : 		fespace WTh(Th,[P2,P2]);	
  163 : 		
  164 : 	Wh gradient; 			//Gradient
  165 : 	WSh [d1,d2];			//extension field
  166 : 	WSh [theta1,theta2];		//test functions for the extension field
  167 : 	WSh [u1,u2],[v1,v2];		//Displacement and Test functions
  168 : 
  169 : 	//Interpolated Finite elements on the coarse mesh
  170 : 	WTh [D1,D2],[Dprev1,Dprev2]; 
  171 : 	WTh [U1,U2],[Uprev1,Uprev2];
  172 : 
  173 : 	int nsaved=0;			//Initialization counter of the back-up copies
  174 : 	int nsave0=100;			//Current number of back-up copies
  175 : 	real compliance;		//Compliance
  176 : 	real volume;
 *** Warning  The identifier volume hide a Global identifier  
			//Volume of the current shape
  177 : 	real perimeter;			//Perimeter of the optimized boundary
  178 : 	string caption;			//Caption for graphic outputs
  179 : 	real GradNorm;			//Gradient Norm
  180 : 	real GradProduct;		//Scalar product between the current gradient and the previous one
  181 : 	bool rollback=false;		//Did we roll back ?
  182 : 	real actualstep;		//Actual step size
  183 : 	real lagrange;			//Lagrange Multiplier associated to the Volume constraint
  184 : 	real[int] isoval(20);		//isovalue used for graphic outputs
  185 : 
  186 : 	int constrained=1;
  187 : 	if (volume0<0) {constrained=0;};
  188 : 
  189 : /////////////////////////
  190 : // Elasticity Problem  //
  191 : /////////////////////////
  192 : 	problem elasticity([u1,u2],[v1,v2]) =
  193 : 		int2d(Sh)(
  194 :         		2.*mu*(dx(u1)*dx(v1)+dy(u2)*dy(v2)+((dx(u2)+dy(u1))*(dx(v2)+dy(v1)))/2.)
  195 :               		+lambda*(dx(u1)+dy(u2))*(dx(v1)+dy(v2)))
  196 : 		-int1d(Sh,neumann)(g1*v1+g2*v2)	           
  197 :     	+on(FREE,u1=0,u2=0);
  198 : 
  199 : ////////////////////////////////////////
  200 : // Expression of the shape's Gradient //
  201 : ////////////////////////////////////////
  202 : 	macro gradientexp()
  203 # 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 # //
  205 : 
  206 : ///////////////////////
  207 : // Extension Problem //
  208 : ///////////////////////
  209 : //  H1 scalar product between vector-valued functions
  210 : 	macro prodscal(t1,t2,p1,p2)
  211 # 		dx(t1)*dx(p1)+dy(t1)*dy(p1)+dx(t2)*dx(p2)+dy(t2)*dy(p2)+t1*p1+t2*p2
  212 #  )  //
  213 : 	problem extension([d1,d2],[theta1,theta2]) =
  214 : 		int2d(Sh)(prodscal(d1,d2,theta1,theta2)
  211 @ 		
  212 @ 
  211 @ 		dx(d1)*dx(theta1)+dy(d1)*dy(theta1)+dx(d2)*dx(theta2)+dy(d2)*dy(theta2)+d1*theta1+d2*theta2
  212 @ )
  215 : 		+int1d(Sh,free) ((theta1*N.x+theta2*N.y)*(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @  + lagrange*constrained)*cut)
  216 : 	  +on(WALL,d1=0,d2=0);
  217 : 
  218 : //////////////////////////////
  219 : //      Initialization      //
  220 : //////////////////////////////
  221 : int iter,iter0;
  222 : string  backupnameNb;
  223 : if(!tocontinue){
  224 : 	iter0=1;
  225 : 	if (volume0==0) {volume0=int1d(Sh)(x*N.x+y*N.y)/2;}	// Computation of the initial Volume
  226 : 	elasticity;						// Solving the State Equation
  227 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);		// Initial Compliance
  228 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );				// Computation of the shape derivative
  229 : 
  230 : 	//Evaluation of the Lagrande Multiplier associated to the Volume constraint
  231 : 	lagrange=int1d(Sh,free)(gradient*cut)/int1d(Sh,free)(cut);
  232 : 	gradient=(gradient-lagrange*constrained)*cut;
  233 : 
  234 : 	//Mesh Adaptation
  235 : 		Th=Sh;
  236 : 		[U1,U2]=[u1,u2];   //interpolation of u on the coarse mesh Th
  237 : 		[Uprev1,Uprev2]=[0,0]; Uprev1[]=U1[]; Uprev2[]=U2[];
  238 : 		Sh=adaptmesh (Th,Uprev1,Uprev2,err=errelas);
  239 : 		actualstep=initialstep;			//Initialization of the initial step
  240 : 
  241 : 	//We save the intial shape
  242 : 	if (nsave!=0) {
  243 : 		//isovalue for graphic output
  244 : 			real gmax=gradient[].max;
  245 : 			real gmin=gradient[].min;
  246 : 			for (int j=0;j<isoval.n;j++) isoval[j]=gmin+(gmax-gmin)/isoval.n*j;
  247 : 		caption="Initial shape, Compliance "+compliance+", Volume "+volume0;
  248 : 		backupnameNb=backupname+nsaved;
  249 : 		plot(gradient,fill=1,value=1,cmm=caption,viso=isoval,ps= "output/"+backupnameNb+".eps");};}
  250 : else {
  251 : // We recover the datas of a previous computation
  252 : 	// Updating of the meshs if we continue a previous computation
  253 : 		Sh=readmesh(backupname+".msh");
  254 : 		Th=readmesh(backupname+"-geo.msh");
  255 : 		Shprev=readmesh(backupname+"-prev.msh");
  256 : 		Thprev=readmesh(backupname+"-geo-prev.msh");
  257 : 	ifstream f(backupname+".txt");
  258 : 	if (volume0==0) {f >>volume0;} else {real next; f >>next;};
  259 : 	f >>lagrange;		//Lagrange Multiplier
  260 : 	f >>actualstep;		//Actual step size
  261 : 	f >>rollback;		//Did we roll back ?
  262 : 	f >>iter0;		//iteration de dÃ©part
  263 : 	f >>nsave0;		//Number of previous back-up copies
  264 : 	f >>isoval;
  265 : 	f >>Dprev1[];f>>Dprev2[];//Previous extenstion fields
  266 : 	nsaved=nsave0; 
  267 : 	nsave0=nsave0+1;};
  268 : 
  269 : /////////////////////////////////////
  270 : // Initialization of the Algorithm //
  271 : /////////////////////////////////////
  272 : 	elasticity;					//Solving the state equation
  273 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);	//Initial compliance
  274 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );			//Computation of the shape derivative
  275 : 	//Evaluation of the Lagrange Multiplier associated to the Volume constraint
  276 : 	lagrange=int1d(Sh,free)(gradient*cut)/int1d(Sh,free)(cut);
  277 : 	gradient=(gradient-lagrange*constrained)*cut;
  278 : 
  279 : ///////////////////////////////
  280 : //     Optimization Loop     //
  281 : ///////////////////////////////
  282 : for (iter=iter0;iter< niter+iter0;iter=iter+1){
  283 : 	cout <<"Iteration " <<iter <<" ----------------------------------------" <<endl;
  284 : 
  285 : 	////////////////////////////
  286 : 	// Gradient's Computation //
  287 : 	////////////////////////////
  288 : 	elasticity;
  289 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);
  290 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ )*cut;
  291 : 	cout<<"Compliance :"<<compliance<<"-------------------------------------"<<endl;
  292 : 
  293 : 	[U1,U2]=[u1,u2];  //interpolation of u on the coarse mesh
  294 : 
  295 : 	//Update of the lagrange multiplier
  296 : 		volume=int1d(Sh)(x*N.x+y*N.y)/2;
  297 : 		perimeter=int1d(Sh,free)(cut);
  298 : 		lagrange=0.5*lagrange+0.5*int1d(Sh,free)(gradient)/perimeter
  299 : 		+lagrangestep*(volume-volume0)/volume0;
  300 : 	gradient=gradient-lagrange*constrained*cut;
  301 : 	
  302 : 	/////////////////////
  303 : 	// Graphic Outputs //
  304 : 	/////////////////////
  305 : 	//isovalues
  306 : 		real gmax=gradient[].max;
  307 : 		for (int j=0;j<isoval.n;j++) 
  308 : 		isoval[j]=isoval[j]*(0.7*isoval[isoval.n-1]+0.3*gmax)/isoval[isoval.n-1];
  309 : 	caption="Iteration "+iter+", Compliance="+compliance+", Volume="+volume;
  310 : 	backupnameNb="output/"+backupname+nsaved+".eps";
  311 : 	plot(gradient,fill=1,value=1,cmm=caption,viso=isoval);
  312 : 	
  313 : 	/////////////////////////
  314 : 	// Back-up Iterations  //
  315 : 	/////////////////////////
  316 : 	if ((nsaved-nsave0)*niter<(iter-iter0-1)*nsave) {
  317 : 	nsaved=nsaved+1;
  318 : 	caption="Iteration "+iter+", Compliance ="+compliance+", Volume="+volume;
  319 : 	backupnameNb="output/"+backupname+nsaved+".eps";
  320 : 	plot(gradient,fill=1,value=1,cmm=caption,viso=isoval,ps=backupnameNb);
  321 : 	savemesh(Sh,backupname+".msh");};
  322 : 
  323 : 	///////////////////////////////
  324 : 	// Modification of the shape //
  325 : 	///////////////////////////////
  326 : 	extension;		//Computation of the field [d1,d2]
  327 : 	[D1,D2]=[d1,d2];	//Interpolation on the coarse mesh
  328 : 
  329 : 	////////////////////////////////////
  330 : 	// Updating the step              //
  331 : 	////////////////////////////////////
  332 : 	GradNorm=int2d(Th)(prodscal(D1,D2,D1,D2)
  211 @ 		
  212 @ 
  211 @ 		dx(D1)*dx(D1)+dy(D1)*dy(D1)+dx(D2)*dx(D2)+dy(D2)*dy(D2)+D1*D1+D2*D2
  212 @ );
  333 : 	GradProduct=int2d(Th)(prodscal(D1,D2,Dprev1,Dprev2)
  211 @ 		
  212 @ 
  211 @ 		dx(D1)*dx(Dprev1)+dy(D1)*dy(Dprev1)+dx(D2)*dx(Dprev2)+dy(D2)*dy(Dprev2)+D1*Dprev1+D2*Dprev2
  212 @ );
  334 : 	if ((GradProduct<0.)&(!rollback)) {
  335 : 		actualstep=actualstep*GradNorm/(GradNorm-GradProduct)/4.; 
  336 :                 cout<<"Step too big: we step back !!!"<<endl; Th=Thprev; Sh=Shprev; rollback=true;}
  337 : 	else 
  338 : 		rollback=false;
  339 : 	if ((GradProduct>0.)&(GradProduct<(GradNorm/2.))){
  340 : 		actualstep=actualstep*2.*GradNorm/(2.*GradNorm-GradProduct); 
  341 :                 cout<<"We increase the step size"<<endl;};
  342 : 	if (GradProduct>(GradNorm/2.)){
  343 : 		actualstep=actualstep*4./3.;
  344 : 		cout<<"We increase the step size"<<endl;};
  345 : 	if(maxstep>0.) 
  346 : 		actualstep=min(actualstep,maxstep);
  347 : 	Thprev=Th;	//We keep a copy of the meshs (in case of backup at the next loop's step)
  348 : 	Shprev=Sh;
  349 : 
  350 : 	//////////////////////////////////
  351 : 	// We move the coarse mesh Th   //
  352 : 	//////////////////////////////////
  353 : 	if (!rollback){
  354 : 		real aa,minaire=checkmovemesh (Th,[x,y])/10000.;
  355 : 		while (minaire > (aa=checkmovemesh(Th,[x+actualstep*D1,y+actualstep*D2])) ){
  356 :   			cout << " problem reversed triangle  => actualstep= actual
  ... : step/2. "<<endl; 
  357 : 			actualstep= actualstep/2.;
  358 : 					}
  359 : 		Th = movemesh (Th,[x+actualstep*D1,y+actualstep*D2]);
  360 : 		cout<<"Mesh moved"<<endl;
  361 : 		cout<<"Actual Step "<<actualstep<<"------------------------------------"<<endl;
  362 : 		[Dprev1,Dprev2]=[0,0];
  363 : 		Dprev1[]=D1[];Dprev2[]=D2[];
  364 : 		[Uprev1,Uprev2]=[0,0]; Uprev1[]=U1[]; Uprev2[]=U2[]; //Interpolation of u on the new mesh Th
  365 : 		};
  366 : 
  367 : 	//////////////////////
  368 : 	// Mesh Adaptation  //
  369 : 	//////////////////////
  370 : 	if (rollback){Sh=Shprev; } 		//We step back
  371 : 	else {
  372 : 		cout<<"Mesh adaptation of Sh"<<endl;
  373 : 		Sh=adaptmesh(Th,Uprev1,Uprev2,[Dprev1,Dprev2],err=errelas);
  374 : 		plot(Sh,wait=0);
  375 : 		cout<<"Mesh adaptation of the coarse mesh Th"<<endl;
  376 : 		Th=adaptmesh(Sh,metricmsh,0,metricmsh,IsMetric=1,ratio=0,omega=200,splitpbedge=1,hmin=0.05,abserror=1); }
  377 : 	cout<<"Mesh adaptation done"<<endl;
  378 : };
  379 : ///// END OF THE OPTIMIZATION LOOP /////
  380 : 
  381 : // Back-up    ///////////////////////////////////////////////
  382 : if (nsave!=0) {
  383 : 	//We save the meshes
  384 : 		savemesh(Sh,backupname+".msh");
  385 : 		savemesh(Shprev,backupname+"-prev.msh");
  386 : 		savemesh(Th,backupname+"-geo.msh");
  387 : 		savemesh(Th,backupname+"-geo-prev.msh");
  388 : 	//We save all variables
  389 : 		{ofstream f(backupname+".txt");
  390 : 		f << volume0<<"\n";	//Initial Volume
  391 : 		f <<lagrange<<"\n";	//Lagrange Multiplier
  392 : 		f <<actualstep<<"\n";	//Actual step
  393 : 		f <<rollback<<"\n";	//boolean variable
  394 : 		f <<iter<<"\n";		//Current Iteration
  395 : 		f <<nsaved+1<<"\n";	//Number of back-up done
  396 : 		f <<isoval<<"\n";
  397 : 		[Dprev1,Dprev2]=[Dprev1,Dprev2];
  398 : 		f <<Dprev1[]<<endl;f<<Dprev2[]<<endl;};
  399 : 	nsaved=nsaved+1;
  400 : 	elasticity;
  401 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );
  402 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);
  403 : 	cout<<"Compliance : "<<compliance<<"-------------------------------------"<<endl;
  404 : 	gradient=gradient*cut;
  405 : 	volume=int2d(Sh)(1.);
  406 : 	perimeter=int1d(Sh,free)(cut);
  407 : 	lagrange=0.5*lagrange+0.5*int1d(Sh,free)(gradient)/perimeter+lagrangestep*(volume-volume0)/volume0;
  408 : 	gradient=gradient-lagrange*constrained*cut;
  409 : 	//Graphic output of the gradient
  410 : 		caption="Iteration "+iter+", Compliance ="+compliance+", Volume="+volume;
  411 : 		backupnameNb=backupname+nsaved+".eps";
  412 : 		plot(gradient,fill=1,value=0,cmm=caption,viso=isoval,ps="output/"+ backupnameNb);
  413 : };
  414 :  sizestack + 1024 =11480  ( 10456 )

  --  mesh:  Nb of Triangles =  23310, Nb of Vertices 11973
  -- Solve : 
          min -0.027306  max 0.114275
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 3710 , h  min 0.000850932 , h max 0.155826
     area =  0.616675 , M area = 1650.71 , M area/( |Khat| nt) 1.02753
     infiny-regularity:  min 0.402909  max 2.63669
     anisomax  5.91788, beta max = 1.27495 min  0.734449
  --  mesh:  Nb of Triangles =   3710, Nb of Vertices 2011
  -- Solve : 
          min -0.027689  max 0.115488
Iteration 1 ----------------------------------------
  -- Solve : 
          min -0.027689  max 0.115488
Compliance :0.430969-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -0.504424  max 4.88918
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.025------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 4378 , h  min 0.000993194 , h max 0.132673
     area =  0.600684 , M area = 1987.79 , M area/( |Khat| nt) 1.04856
     infiny-regularity:  min 0.385386  max 2.3223
     anisomax  6.41162, beta max = 1.31316 min  0.744668
  --  mesh:  Nb of Triangles =   4378, Nb of Vertices 2367
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 316 , h  min 0.00533312 , h max 0.47048
     area =  0.600625 , M area = 14.0442 , M area/( |Khat| nt) 0.102638
     infiny-regularity:  min 0.00144942  max 8.84446
     anisomax  94.6741, beta max = 153.442 min  0.520733
  --  mesh:  Nb of Triangles =    316, Nb of Vertices 206
Mesh adaptation done
Iteration 2 ----------------------------------------
  -- Solve : 
          min -0.019359  max 0.0991675
Compliance :0.359224-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.00876  max 13.7395
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0131576------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1280 , h  min 0.00267878 , h max 0.119032
     area =  0.563554 , M area = 548.242 , M area/( |Khat| nt) 0.989149
     infiny-regularity:  min 0.108448  max 2.48201
     anisomax  14.8739, beta max = 2.83624 min  0.745738
  --  mesh:  Nb of Triangles =   1280, Nb of Vertices 744
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 310 , h  min 0.00527443 , h max 0.481875
     area =  0.563464 , M area = 5.4571 , M area/( |Khat| nt) 0.0406537
     infiny-regularity:  min 0.0018948  max 6.25036
     anisomax  42.3075, beta max = 140.471 min  0.663373
  --  mesh:  Nb of Triangles =    310, Nb of Vertices 202
Mesh adaptation done
Iteration 3 ----------------------------------------
  -- Solve : 
          min -6.14149e-05  max 0.0771839
Compliance :0.257402-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.15743  max 11.355
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00877176------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1108 , h  min 0.00184683 , h max 0.133348
     area =  0.547077 , M area = 459.967 , M area/( |Khat| nt) 0.958708
     infiny-regularity:  min 0.127909  max 2.15933
     anisomax  37.8178, beta max = 2.74138 min  0.619058
  --  mesh:  Nb of Triangles =   1108, Nb of Vertices 665
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00525097 , h max 0.529527
     area =  0.547749 , M area = 3.38005 , M area/( |Khat| nt) 0.0256772
     infiny-regularity:  min 0.00191112  max 3.24271
     anisomax  66.1697, beta max = 141.472 min  1.38431
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 4 ----------------------------------------
  -- Solve : 
          min -9.47628e-07  max 0.066474
Compliance :0.211911-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.2222  max 10.9915
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00292392------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 950 , h  min 0.00243505 , h max 0.136719
     area =  0.543283 , M area = 386.974 , M area/( |Khat| nt) 0.940714
     infiny-regularity:  min 0.110387  max 2.90813
     anisomax  16.5657, beta max = 2.71235 min  0.718747
  --  mesh:  Nb of Triangles =    950, Nb of Vertices 583
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00524481 , h max 0.546577
     area =  0.543127 , M area = 3.094 , M area/( |Khat| nt) 0.0235042
     infiny-regularity:  min 0.00191864  max 1.31384
     anisomax  113.454, beta max = 141.684 min  1.39836
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 5 ----------------------------------------
  -- Solve : 
          min -2.85325e-07  max 0.0637134
Compliance :0.199841-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.21986  max 10.1934
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00181471------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 953 , h  min 0.00281614 , h max 0.158428
     area =  0.540737 , M area = 390.556 , M area/( |Khat| nt) 0.946432
     infiny-regularity:  min 0.0101523  max 3.42403
     anisomax  367.996, beta max = 5.00287 min  0.606486
  --  mesh:  Nb of Triangles =    953, Nb of Vertices 583
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00524167 , h max 0.556388
     area =  0.540576 , M area = 3.06246 , M area/( |Khat| nt) 0.0232646
     infiny-regularity:  min 0.00188563  max 1.33555
     anisomax  168.383, beta max = 141.813 min  1.40578
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 6 ----------------------------------------
  -- Solve : 
          min -1.52033e-07  max 0.062007
Compliance :0.193996-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.16863  max 10.7654
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00102014------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 931 , h  min 0.00284796 , h max 0.131839
     area =  0.539263 , M area = 379.164 , M area/( |Khat| nt) 0.940539
     infiny-regularity:  min 0.0997703  max 2.74108
     anisomax  37.3598, beta max = 2.96363 min  0.756054
  --  mesh:  Nb of Triangles =    931, Nb of Vertices 574
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523993 , h max 0.562225
     area =  0.539102 , M area = 3.05401 , M area/( |Khat| nt) 0.0232004
     infiny-regularity:  min 0.00188153  max 1.3485
     anisomax  223.024, beta max = 141.839 min  1.40987
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 7 ----------------------------------------
  -- Solve : 
          min -2.47236e-07  max 0.0616176
Compliance :0.189305-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.16116  max 11.0807
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000596417------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 918 , h  min 0.00256212 , h max 0.15299
     area =  0.538401 , M area = 369.24 , M area/( |Khat| nt) 0.928891
     infiny-regularity:  min 0.0773155  max 2.58547
     anisomax  36.489, beta max = 2.82814 min  0.738948
  --  mesh:  Nb of Triangles =    918, Nb of Vertices 567
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523887 , h max 0.565722
     area =  0.538238 , M area = 3.04726 , M area/( |Khat| nt) 0.0231492
     infiny-regularity:  min 0.00187967  max 1.35628
     anisomax  265.13, beta max = 141.862 min  1.41216
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 8 ----------------------------------------
  -- Solve : 
          min -2.26356e-07  max 0.0610416
Compliance :0.186792-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.16856  max 10.9419
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000362444------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 888 , h  min 0.00227541 , h max 0.140843
     area =  0.537895 , M area = 359.91 , M area/( |Khat| nt) 0.93601
     infiny-regularity:  min 0.0771161  max 2.60303
     anisomax  38.8608, beta max = 3.20019 min  0.760753
  --  mesh:  Nb of Triangles =    888, Nb of Vertices 551
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523827 , h max 0.567819
     area =  0.537731 , M area = 3.03173 , M area/( |Khat| nt) 0.0230312
     infiny-regularity:  min 0.00187837  max 1.36094
     anisomax  290.454, beta max = 141.899 min  1.41351
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 9 ----------------------------------------
  -- Solve : 
          min -1.71143e-07  max 0.0616026
Compliance :0.187093-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19115  max 11.2166
We increase the step size
Mesh moved
Actual Step 0.000470862------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 902 , h  min 0.00136228 , h max 0.15172
     area =  0.537238 , M area = 370.631 , M area/( |Khat| nt) 0.94893
     infiny-regularity:  min 0.045492  max 2.7454
     anisomax  90.6444, beta max = 3.40236 min  0.754728
  --  mesh:  Nb of Triangles =    902, Nb of Vertices 560
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523759 , h max 0.570598
     area =  0.537072 , M area = 3.03938 , M area/( |Khat| nt) 0.0230893
     infiny-regularity:  min 0.00116617  max 1.37983
     anisomax  345.922, beta max = 142.051 min  1.41522
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 10 ----------------------------------------
  -- Solve : 
          min -1.032e-07  max 0.0614884
Compliance :0.186146-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.1958  max 11.1969
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000277025------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 919 , h  min 0.0019719 , h max 0.1501
     area =  0.536861 , M area = 376.679 , M area/( |Khat| nt) 0.946575
     infiny-regularity:  min 0.0365817  max 4.4634
     anisomax  118.247, beta max = 6.48733 min  0.697037
  --  mesh:  Nb of Triangles =    919, Nb of Vertices 569
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523719 , h max 0.572231
     area =  0.536694 , M area = 3.03122 , M area/( |Khat| nt) 0.0230273
     infiny-regularity:  min 0.0018759  max 1.38369
     anisomax  530.643, beta max = 142.135 min  1.34524
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 11 ----------------------------------------
  -- Solve : 
          min -1.20114e-07  max 0.0609266
Compliance :0.185255-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19724  max 9.85855
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000183348------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 931 , h  min 0.00169066 , h max 0.146713
     area =  0.536649 , M area = 384.278 , M area/( |Khat| nt) 0.953223
     infiny-regularity:  min 0.0528126  max 5.55906
     anisomax  74.8424, beta max = 5.52182 min  0.727564
  --  mesh:  Nb of Triangles =    931, Nb of Vertices 575
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523692 , h max 0.573191
     area =  0.536483 , M area = 3.03447 , M area/( |Khat| nt) 0.023052
     infiny-regularity:  min 0.00130208  max 1.38596
     anisomax  766.865, beta max = 142.188 min  1.34555
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 12 ----------------------------------------
  -- Solve : 
          min -1.18049e-07  max 0.0608439
Compliance :0.183855-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.22459  max 9.1096
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000121459------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 920 , h  min 0.000932571 , h max 0.148011
     area =  0.536246 , M area = 384.345 , M area/( |Khat| nt) 0.96479
     infiny-regularity:  min 0.00477067  max 5.58687
     anisomax  731.407, beta max = 10.8025 min  0.756853
  --  mesh:  Nb of Triangles =    920, Nb of Vertices 570
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523678 , h max 0.573779
     area =  0.53645 , M area = 3.14009 , M area/( |Khat| nt) 0.0238544
     infiny-regularity:  min 0.000233019  max 7.36126
     anisomax  2214.96, beta max = 142.217 min  1.34572
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 13 ----------------------------------------
  -- Solve : 
          min -5.75455e-08  max 0.0596567
Compliance :0.181345-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.25247  max 10.5153
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 7.00796e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 855 , h  min 0.00281819 , h max 0.167886
     area =  0.536527 , M area = 344.668 , M area/( |Khat| nt) 0.930967
     infiny-regularity:  min 0.0254374  max 2.5304
     anisomax  236.846, beta max = 10.3779 min  0.771506
  --  mesh:  Nb of Triangles =    855, Nb of Vertices 536
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523667 , h max 0.574166
     area =  0.53636 , M area = 3.0446 , M area/( |Khat| nt) 0.023129
     infiny-regularity:  min 0.000278991  max 1.38828
     anisomax  1426.55, beta max = 141.861 min  1.34584
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 14 ----------------------------------------
  -- Solve : 
          min -6.33744e-06  max 0.0603102
Compliance :0.18333-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19511  max 10.6554
We increase the step size
Mesh moved
Actual Step 8.56142e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 905 , h  min 0.000531697 , h max 0.161431
     area =  0.536421 , M area = 372.107 , M area/( |Khat| nt) 0.949552
     infiny-regularity:  min 0.0129131  max 6.40528
     anisomax  335.918, beta max = 14.7628 min  0.627177
  --  mesh:  Nb of Triangles =    905, Nb of Vertices 561
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523654 , h max 0.574644
     area =  0.536252 , M area = 3.01907 , M area/( |Khat| nt) 0.022935
     infiny-regularity:  min 0.000402021  max 1.38942
     anisomax  2488.39, beta max = 141.861 min  1.34597
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 15 ----------------------------------------
  -- Solve : 
          min -1.89374e-08  max 0.0608463
Compliance :0.182489-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.20118  max 10.9815
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 4.77475e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 948 , h  min 0.000694856 , h max 0.151072
     area =  0.536359 , M area = 391.512 , M area/( |Khat| nt) 0.953754
     infiny-regularity:  min 0.0071831  max 6.3181
     anisomax  573.243, beta max = 10.4783 min  0.720069
  --  mesh:  Nb of Triangles =    948, Nb of Vertices 583
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523646 , h max 0.57492
     area =  0.53619 , M area = 3.01251 , M area/( |Khat| nt) 0.0228852
     infiny-regularity:  min 0.000227078  max 1.39008
     anisomax  4406.93, beta max = 142.275 min  1.34605
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 16 ----------------------------------------
  -- Solve : 
          min -1.12105e-07  max 0.0614251
Compliance :0.18418-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.21912  max 11.5002
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 2.59981e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 912 , h  min 0.000631309 , h max 0.148714
     area =  0.536326 , M area = 373.65 , M area/( |Khat| nt) 0.946172
     infiny-regularity:  min 0.00569144  max 6.42275
     anisomax  1024.11, beta max = 16.759 min  0.749317
  --  mesh:  Nb of Triangles =    912, Nb of Vertices 561
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523642 , h max 0.575077
     area =  0.536157 , M area = 3.0112 , M area/( |Khat| nt) 0.0228753
     infiny-regularity:  min 0.000131898  max 1.39045
     anisomax  7588.73, beta max = 142.284 min  1.3461
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 17 ----------------------------------------
  -- Solve : 
          min -3.26716e-07  max 0.0612459
Compliance :0.184448-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.21065  max 11.0924
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.48951e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 921 , h  min 0.00037502 , h max 0.16345
     area =  0.536306 , M area = 380.153 , M area/( |Khat| nt) 0.953232
     infiny-regularity:  min 0.00251722  max 6.49112
     anisomax  1636.04, beta max = 15.6955 min  0.671703
  --  mesh:  Nb of Triangles =    921, Nb of Vertices 569
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.0052364 , h max 0.575164
     area =  0.536138 , M area = 3.01578 , M area/( |Khat| nt) 0.02291
     infiny-regularity:  min 7.96732e-05  max 1.39065
     anisomax  12564.6, beta max = 142.289 min  1.34613
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 18 ----------------------------------------
  -- Solve : 
          min -1.03923e-07  max 0.0609056
Compliance :0.18387-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.20951  max 10.9646
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 8.72491e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 874 , h  min 0.00250516 , h max 0.150257
     area =  0.536297 , M area = 355.135 , M area/( |Khat| nt) 0.938386
     infiny-regularity:  min 0.00207821  max 5.92829
     anisomax  2812.24, beta max = 21.8613 min  0.711769
  --  mesh:  Nb of Triangles =    874, Nb of Vertices 543
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523639 , h max 0.575215
     area =  0.536128 , M area = 3.01625 , M area/( |Khat| nt) 0.0229136
     infiny-regularity:  min 4.80517e-05  max 1.39078
     anisomax  20833.3, beta max = 146.773 min  1.34613
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 19 ----------------------------------------
  -- Solve : 
          min -1.4663e-07  max 0.0614853
Compliance :0.184401-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.20209  max 11.2472
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 5.60173e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 934 , h  min 0.000707803 , h max 0.140781
     area =  0.53629 , M area = 389.584 , M area/( |Khat| nt) 0.963283
     infiny-regularity:  min 0.000934171  max 5.09606
     anisomax  4432.24, beta max = 25.6114 min  0.747198
  --  mesh:  Nb of Triangles =    934, Nb of Vertices 575
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523638 , h max 0.575248
     area =  0.53612 , M area = 3.01727 , M area/( |Khat| nt) 0.0229213
     infiny-regularity:  min 2.98704e-05  max 1.39086
     anisomax  33517.8, beta max = 186.152 min  1.34614
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 20 ----------------------------------------
  -- Solve : 
          min -9.36321e-08  max 0.0609024
Compliance :0.183788-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.22596  max 11.1473
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 3.34986e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 914 , h  min 0.00121673 , h max 0.149901
     area =  0.536286 , M area = 373.177 , M area/( |Khat| nt) 0.942906
     infiny-regularity:  min 0.000773441  max 5.51784
     anisomax  7648.84, beta max = 35.7423 min  0.714434
  --  mesh:  Nb of Triangles =    914, Nb of Vertices 564
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523637 , h max 0.575268
     area =  0.536116 , M area = 3.01544 , M area/( |Khat| nt) 0.0229074
     infiny-regularity:  min 1.76293e-05  max 1.3909
     anisomax  56790.9, beta max = 242.302 min  1.34615
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 21 ----------------------------------------
  -- Solve : 
          min -1.26853e-07  max 0.0609911
Compliance :0.183056-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.18414  max 11.2454
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 2.04636e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 959 , h  min 0.0021911 , h max 0.140171
     area =  0.536282 , M area = 392.391 , M area/( |Khat| nt) 0.944929
     infiny-regularity:  min 0.000483042  max 6.85779
     anisomax  12124.5, beta max = 39.8715 min  0.72234
  --  mesh:  Nb of Triangles =    959, Nb of Vertices 585
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523637 , h max 0.57528
     area =  0.536114 , M area = 3.01144 , M area/( |Khat| nt) 0.022877
     infiny-regularity:  min 1.11418e-05  max 1.39093
     anisomax  89873.9, beta max = 304.819 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 22 ----------------------------------------
  -- Solve : 
          min -7.08807e-08  max 0.0613186
Compliance :0.184366-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.22023  max 11.1951
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.24451e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 898 , h  min 0.00238287 , h max 0.1502
     area =  0.536281 , M area = 376.653 , M area/( |Khat| nt) 0.968645
     infiny-regularity:  min 0.000300044  max 5.94346
     anisomax  17218.2, beta max = 44.9608 min  0.704795
  --  mesh:  Nb of Triangles =    898, Nb of Vertices 556
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523637 , h max 0.575287
     area =  0.536112 , M area = 3.01624 , M area/( |Khat| nt) 0.0229135
     infiny-regularity:  min 6.87794e-06  max 1.39094
     anisomax  145541, beta max = 387.916 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 23 ----------------------------------------
  -- Solve : 
          min -1.28743e-07  max 0.0611356
Compliance :0.183954-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19599  max 11.3182
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 7.89554e-07------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 953 , h  min 0.000336749 , h max 0.165523
     area =  0.53628 , M area = 389.162 , M area/( |Khat| nt) 0.943055
     infiny-regularity:  min 0.000138744  max 4.34203
     anisomax  29650.9, beta max = 66.9328 min  0.760231
  --  mesh:  Nb of Triangles =    953, Nb of Vertices 584
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575292
     area =  0.536111 , M area = 3.0121 , M area/( |Khat| nt) 0.022882
     infiny-regularity:  min 4.39946e-06  max 1.39096
     anisomax  227568, beta max = 485.151 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 24 ----------------------------------------
  -- Solve : 
          min -1.27837e-07  max 0.061779
Compliance :0.184613-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.24231  max 11.3092
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 4.67485e-07------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 907 , h  min 0.00211168 , h max 0.143453
     area =  0.53628 , M area = 373.755 , M area/( |Khat| nt) 0.951653
     infiny-regularity:  min 0.000115059  max 6.52407
     anisomax  50992.4, beta max = 82.5079 min  0.721052
  --  mesh:  Nb of Triangles =    907, Nb of Vertices 562
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575295
     area =  0.53611 , M area = 3.02081 , M area/( |Khat| nt) 0.0229482
     infiny-regularity:  min 2.65077e-06  max 1.39097
     anisomax  377970, beta max = 625.041 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 25 ----------------------------------------
  -- Solve : 
          min -8.63065e-07  max 0.0616243
Compliance :0.184512-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.22095  max 11.0387
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 2.81143e-07------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 933 , h  min 0.000389032 , h max 0.153729
     area =  0.536278 , M area = 381.052 , M area/( |Khat| nt) 0.943195
     infiny-regularity:  min 5.48182e-05  max 3.90772
     anisomax  76034.6, beta max = 118.997 min  0.64244
  --  mesh:  Nb of Triangles =    933, Nb of Vertices 573
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575297
     area =  0.53611 , M area = 3.01243 , M area/( |Khat| nt) 0.0228846
     infiny-regularity:  min 1.70796e-06  max 1.39096
     anisomax  586491, beta max = 778.59 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 26 ----------------------------------------
  -- Solve : 
          min -7.5598e-08  max 0.0609745
Compliance :0.18269-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.20979  max 11.3781
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.68369e-07------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 958 , h  min 0.00201918 , h max 0.15866
     area =  0.536279 , M area = 397.192 , M area/( |Khat| nt) 0.957491
     infiny-regularity:  min 4.75443e-05  max 6.54721
     anisomax  122752, beta max = 127.714 min  0.695897
  --  mesh:  Nb of Triangles =    958, Nb of Vertices 587
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575298
     area =  0.53611 , M area = 3.01867 , M area/( |Khat| nt) 0.022932
     infiny-regularity:  min 1.09921e-06  max 1.39097
     anisomax  910509, beta max = 970.326 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 27 ----------------------------------------
  -- Solve : 
          min -9.13804e-07  max 0.0614041
Compliance :0.18499-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.23622  max 11.2262
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.07009e-07------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 926 , h  min 0.00228601 , h max 0.149664
     area =  0.536278 , M area = 380.058 , M area/( |Khat| nt) 0.947848
     infiny-regularity:  min 3.17092e-05  max 5.36365
     anisomax  161810, beta max = 134.257 min  0.69709
  --  mesh:  Nb of Triangles =    926, Nb of Vertices 571
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575298
     area =  0.53611 , M area = 3.01752 , M area/( |Khat| nt) 0.0229232
     infiny-regularity:  min 7.36327e-07  max 1.39097
     anisomax  1.36379e+06, beta max = 1187.27 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 28 ----------------------------------------
  -- Solve : 
          min -3.29615e-07  max 0.0608208
Compliance :0.184045-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.1883  max 11.2101
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 6.89995e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 963 , h  min 0.00146135 , h max 0.144229
     area =  0.536279 , M area = 394.782 , M area/( |Khat| nt) 0.94674
     infiny-regularity:  min 2.00771e-05  max 4.71253
     anisomax  249174, beta max = 189.618 min  0.664832
  --  mesh:  Nb of Triangles =    963, Nb of Vertices 590
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.53611 , M area = 3.02026 , M area/( |Khat| nt) 0.022944
     infiny-regularity:  min 5.20848e-07  max 1.39098
     anisomax  1.92175e+06, beta max = 1410.82 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 29 ----------------------------------------
  -- Solve : 
          min -6.15363e-07  max 0.0611828
Compliance :0.182747-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19564  max 11.4235
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 4.43711e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 915 , h  min 0.00221534 , h max 0.145941
     area =  0.536279 , M area = 376.371 , M area/( |Khat| nt) 0.949937
     infiny-regularity:  min 1.54074e-05  max 6.04792
     anisomax  340471, beta max = 195.7 min  0.74199
  --  mesh:  Nb of Triangles =    915, Nb of Vertices 566
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.53611 , M area = 3.01177 , M area/( |Khat| nt) 0.0228796
     infiny-regularity:  min 3.58635e-07  max 1.39098
     anisomax  2.80678e+06, beta max = 1707.19 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 30 ----------------------------------------
  -- Solve : 
          min -2.23661e-07  max 0.0616358
Compliance :0.183245-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.2147  max 11.1616
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 2.88968e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 938 , h  min 0.000502699 , h max 0.168035
     area =  0.536279 , M area = 384.938 , M area/( |Khat| nt) 0.947736
     infiny-regularity:  min 8.19902e-06  max 5.01308
     anisomax  504367, beta max = 305.142 min  0.667917
  --  mesh:  Nb of Triangles =    938, Nb of Vertices 578
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.0203 , M area/( |Khat| nt) 0.0229444
     infiny-regularity:  min 2.60238e-07  max 1.39098
     anisomax  3.85664e+06, beta max = 1994.05 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 31 ----------------------------------------
  -- Solve : 
          min -5.99672e-07  max 0.0609853
Compliance :0.182792-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.21014  max 11.4019
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.87658e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 900 , h  min 0.00239041 , h max 0.15326
     area =  0.536279 , M area = 370.228 , M area/( |Khat| nt) 0.950006
     infiny-regularity:  min 8.2967e-06  max 5.16266
     anisomax  706076, beta max = 344.935 min  0.693259
  --  mesh:  Nb of Triangles =    900, Nb of Vertices 558
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01698 , M area/( |Khat| nt) 0.0229191
     infiny-regularity:  min 1.92421e-07  max 1.39098
     anisomax  5.2662e+06, beta max = 2336.29 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 32 ----------------------------------------
  -- Solve : 
          min -5.70673e-08  max 0.0614598
Compliance :0.184997-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.2176  max 11.4406
We increase the step size
Mesh moved
Actual Step 2.5021e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 923 , h  min 0.00118323 , h max 0.156555
     area =  0.536279 , M area = 384.318 , M area/( |Khat| nt) 0.961585
     infiny-regularity:  min 4.17064e-06  max 5.07525
     anisomax  1.20309e+06, beta max = 457.073 min  0.767623
  --  mesh:  Nb of Triangles =    923, Nb of Vertices 570
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01964 , M area/( |Khat| nt) 0.0229393
     infiny-regularity:  min 1.11011e-07  max 1.39098
     anisomax  8.98372e+06, beta max = 3077.49 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 33 ----------------------------------------
  -- Solve : 
          min -0.000494926  max 0.0610662
Compliance :0.182012-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.21223  max 11.5031
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.3945e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 953 , h  min 0.0021933 , h max 0.159244
     area =  0.536279 , M area = 394.88 , M area/( |Khat| nt) 0.95691
     infiny-regularity:  min 2.62905e-06  max 5.28919
     anisomax  2.22741e+06, beta max = 547.454 min  0.764582
  --  mesh:  Nb of Triangles =    953, Nb of Vertices 584
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01833 , M area/( |Khat| nt) 0.0229294
     infiny-regularity:  min 6.00685e-08  max 1.39098
     anisomax  1.69405e+07, beta max = 4200.13 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 34 ----------------------------------------
  -- Solve : 
          min -1.08573e-07  max 0.060628
Compliance :0.182772-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19252  max 11.3498
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 7.9466e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 925 , h  min 0.000432664 , h max 0.159174
     area =  0.536278 , M area = 382.083 , M area/( |Khat| nt) 0.953928
     infiny-regularity:  min 9.89063e-07  max 5.02463
     anisomax  4.18765e+06, beta max = 882.73 min  0.62836
  --  mesh:  Nb of Triangles =    925, Nb of Vertices 569
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01245 , M area/( |Khat| nt) 0.0228847
     infiny-regularity:  min 3.332e-08  max 1.39097
     anisomax  3.1117e+07, beta max = 5759.64 min  1.34617
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 35 ----------------------------------------
  -- Solve : 
          min -9.52597e-07  max 0.0607369
Compliance :0.182565-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.20106  max 11.5981
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 2.11981e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 896 , h  min 0.00230242 , h max 0.157394
     area =  0.536279 , M area = 375.799 , M area/( |Khat| nt) 0.968607
     infiny-regularity:  min 9.82262e-07  max 5.71688
     anisomax  4.32996e+06, beta max = 771.331 min  0.739125
  --  mesh:  Nb of Triangles =    896, Nb of Vertices 557
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01765 , M area/( |Khat| nt) 0.0229242
     infiny-regularity:  min 2.35608e-08  max 1.39098
     anisomax  4.18306e+07, beta max = 6698.86 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 36 ----------------------------------------
  -- Solve : 
          min -1.51129e-07  max 0.0608815
Compliance :0.183103-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.18711  max 11.1816
We increase the step size
Mesh moved
Actual Step 2.6896e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 970 , h  min 0.00229614 , h max 0.147305
     area =  0.536279 , M area = 396.892 , M area/( |Khat| nt) 0.944931
     infiny-regularity:  min 6.85858e-07  max 5.81257
     anisomax  8.46783e+06, beta max = 1060.25 min  0.73723
  --  mesh:  Nb of Triangles =    970, Nb of Vertices 593
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.02077 , M area/( |Khat| nt) 0.0229479
     infiny-regularity:  min 1.49012e-08  max 1.39098
     anisomax  7.24377e+07, beta max = 8267.93 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 37 ----------------------------------------
  -- Solve : 
          min -2.35277e-07  max 0.0613791
Compliance :0.184387-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.18717  max 11.2637
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.47833e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 903 , h  min 0.00262086 , h max 0.149097
     area =  0.536278 , M area = 382.127 , M area/( |Khat| nt) 0.977281
     infiny-regularity:  min 4.5768e-07  max 6.60321
     anisomax  8.35137e+06, beta max = 1121.83 min  0.750412
  --  mesh:  Nb of Triangles =    903, Nb of Vertices 559
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01313 , M area/( |Khat| nt) 0.0228899
     infiny-regularity:  min 1.05367e-08  max 1.39097
     anisomax  1.10002e+08, beta max = 9816 min  1.34617
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 38 ----------------------------------------
  -- Solve : 
          min -1.9688e-07  max 0.0610442
Compliance :0.183303-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19976  max 11.2075
We increase the step size
Mesh moved
Actual Step 1.62684e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 952 , h  min 0.000913881 , h max 0.143881
     area =  0.536279 , M area = 391.899 , M area/( |Khat| nt) 0.950685
     infiny-regularity:  min 2.4223e-07  max 6.23676
     anisomax  1.79623e+07, beta max = 1579.23 min  0.699063
  --  mesh:  Nb of Triangles =    952, Nb of Vertices 584
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01143 , M area/( |Khat| nt) 0.022877
     infiny-regularity:  min 0  max 1.39098
     anisomax  inf, beta max = 13868 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 39 ----------------------------------------
  -- Solve : 
          min -5.09417e-08  max 0.0615271
Compliance :0.184037-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.32829  max 5.9537
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 8.41824e-10------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 925 , h  min 0.00185156 , h max 0.156764
     area =  0.536279 , M area = 380.339 , M area/( |Khat| nt) 0.949573
     infiny-regularity:  min 2.04857e-07  max 5.39702
     anisomax  2.8836e+07, beta max = 1945.08 min  0.679624
  --  mesh:  Nb of Triangles =    925, Nb of Vertices 571
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01554 , M area/( |Khat| nt) 0.0229082
     infiny-regularity:  min 0  max 1.39098
     anisomax  inf, beta max = 15872.8 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 40 ----------------------------------------
  -- Solve : 
          min -4.26199e-07  max 0.0612625
Compliance :0.183781-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.26016  max 8.59346
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 4.63426e-10------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 915 , h  min 0.00238679 , h max 0.144848
     area =  0.536278 , M area = 372.861 , M area/( |Khat| nt) 0.941076
     infiny-regularity:  min 1.33176e-07  max 5.47211
     anisomax  3.88554e+07, beta max = 2680.75 min  0.642661
  --  mesh:  Nb of Triangles =    915, Nb of Vertices 566
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01667 , M area/( |Khat| nt) 0.0229168
     infiny-regularity:  min 0  max 1.39097
     anisomax  inf, beta max = 19773.3 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 41 ----------------------------------------
  -- Solve : 
          min -9.01061e-08  max 0.0607352
Compliance :0.18263-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.2171  max 9.624
We increase the step size
Mesh moved
Actual Step 5.00645e-10------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 914 , h  min 0.000953263 , h max 0.141838
     area =  0.536279 , M area = 374.044 , M area/( |Khat| nt) 0.945095
     infiny-regularity:  min 9.51226e-08  max 5.32658
     anisomax  5.11708e+07, beta max = 2877.26 min  0.743945
  --  mesh:  Nb of Triangles =    914, Nb of Vertices 566
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.01128 , M area/( |Khat| nt) 0.0228758
     infiny-regularity:  min 0  max 1.44534
     anisomax  inf, beta max = 28406.4 min  1.34616
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 42 ----------------------------------------
  -- Solve : 
          min -5.38342e-07  max 0.0612321
Compliance :0.183695-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.22544  max 10.3968
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 1.33415e-10------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 895 , h  min 0.00244018 , h max 0.158323
     area =  0.536278 , M area = 369.072 , M area/( |Khat| nt) 0.952329
     infiny-regularity:  min 2.47108e-08  max 6.64177
     anisomax  inf, beta max = 5153.55 min  0.724099
  --  mesh:  Nb of Triangles =    895, Nb of Vertices 555
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 304 , h  min 0.00523636 , h max 0.575299
     area =  0.536109 , M area = 3.02013 , M area/( |Khat| nt) 0.022943
     infiny-regularity:  min 0  max 1.39097
     anisomax  inf, beta max = 62426.2 min  1.34617
  --  mesh:  Nb of Triangles =    304, Nb of Vertices 198
Mesh adaptation done
Iteration 43 ----------------------------------------
  -- Solve : 
          min -3.42752e-09  max 0.0608576
Compliance :0.183122-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.19922  max 10.6161
Step too big: we step back !!!
Mesh adaptation done
Iteration 44 ----------------------------------------
  -- Solve : 
          min -5.38342e-07  max 0.0612321
Compliance :0.183695-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.2156  max 10.9047
Mesh moved
Actual Step 3.27029e-11------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 899 , h  min 0.00259491 , h max 0.148552
     area =  0.536278 , M area = 368.503 , M area/( |Khat| nt) 0.946631
     infiny-regularity:  min 6.49527e-08  max 5.9636
     anisomax  9.98234e+07, beta max = 3198.83 min  0.725153
  --  mesh:  Nb of Triangles =    899, Nb of Vertices 557
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
+++ Fatal Error Triangle (in SetInCoor) area of triangle < 0
 Triangle 438  det  (I2) = -18440597 (R2) 6.20866e-11; The three vertices 
476 477 480 : [0.340817,0.251278][0.323122,0.219704][0.301306,0.180775] ; [444039646,240082459][430570435,216047525][413963877,186414200]
 Fatal error in the mesh generator 899
  current line = 376
Meshing error: Bamg
 number : 899, 
Meshing error: Bamg
 number : 899, 
 err code 5 ,  mpirank 0
