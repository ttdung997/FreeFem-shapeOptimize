-- FreeFem++ v4.700001 (Sat Oct 17 12:48:33 CEST 2020 - git v4.7-64-g08041365)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue 
    1 : ////////////////////////////////////////////////
    2 : // Compliance Optimization                    //
    3 : // by the boundary variation method           //
    4 : // Copyright O.Pantz, G. Allaire (2005)       //
    5 : ////////////////////////////////////////////////
    6 : 
    7 : // Optimization Parameters 
    8 : int niter=60;			//Number of iterations
    9 : real errelas=0.01;		//Error for the resolution of the variational problems
   10 : real metricmsh=5.;		//Metric used for the coarse mesh: Bigger=finer mesh
   11 : real initialstep=0.2;		//Initial step
   12 : real maxstep=-1.;		//Maximum step (<0 => no limit)
   13 : real lagrangestep=3.;		//Updating step of the Lagrange multiplier associated to the Volume's constraint
   14 : bool tocontinue=false;		//false=start a new computation, true=continue a previous computation
   15 : string backupname="output";	//Name under which the results are stored
   16 : int nsave=1;			//Number of iterations to be saved
   17 : real volume0=95.;		//=0 Constant Volume during the iterations, >0 Target Volume, <0 No Volume's constraint
   18 : 
   19 : int np =10;
   20 : // construction of the initial mesh
   21 : 	mesh Sh,Th,Shprev,Thprev;
   22 : 	//Definition of the boundary labels
   23 : 	int neumann=1; int dirichlet=2;
   24 : 	int free=3;
   25 : 
   26 : 
   27 : 	int WALL = 1;
   28 : 	int LOAD = 2;
   29 : 	int FREE = 3;
   30 : //this is case 1
   31 : 	
   32 :  // border L11(t = 0.0, 0.5){x = t; y = 0.0; label = FREE;}
   33 :  //    border L21(t = 0.0, 0.45){x = 0.5; y = t; label = FREE;}
   34 :  //    border L22(t = 0.45, 0.55){x = 0.5; y = t; label = LOAD;}
   35 :  //    border L23(t = 0.55, 1.0){x = 0.5; y = t; label = FREE;}
   36 :  //    border L31(t = 0.5, 0){x = t; y = 1.0; label = FREE;}
   37 :  //    border L41(t = 1.0, 0.9){x = 0.0; y = t; label = WALL;}
   38 :  //    border L42(t = 0.9, 0.1){x = 0.0; y = t; label = FREE;}
   39 :  //    border L43(t = 0.1, 0.0){x = 0.0; y = t; label = WALL;}
   40 : 
   41 :  //    Sh = buildmesh(L11(5 * np) + L21(5 * np) + L22(1 * np) + L23(5 * np) + L31(5 * np) + L41(1 * np) + L42(8 * np) + L43(1 * np));
   42 : 
   43 : 
   44 : //this is case 2
   45 : 
   46 : 	// real r = 0.15;                                                                    
   47 : 
   48 :  //    border L11(t = -1.0, 1.0){x = t; y = 0.0; label = FREE;}
   49 :  //    border L21(t = 0.0, 0.45){x = 1.0; y = t; label = FREE;}
   50 :  //    border L22(t = 0.45, 0.55){x = 1.0; y = t; label = LOAD;}
   51 :  //    border L23(t = 0.55, 1.0){x = 1.0; y = t; label = FREE;}
   52 :  //    border L31(t = 1.0, -1.0){x = t; y = 1.0; label = FREE;}
   53 :  //    border L41(t = 1.0, 0.9){x = -1.0; y = t; label = WALL;}
   54 :  //    border L42(t = 0.9, 0.1){x = -1.0; y = t; label = FREE;}
   55 :  //    border L43(t = 0.1, 0.0){x = -1.0; y = t; label = WALL;}
   56 : 
   57 :     
   58 :  //    border C11(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.22 + r * sin(t); label = FREE;}
   59 :  //    border C12(t = 0, 2 * pi){x = 0.2 + r * cos(t); y = 0.22 + r * sin(t); label = FREE;}
   60 :  //    border C21(t = 0, 2 * pi){x = -0.2 + r * cos(t); y = 0.5 + r * sin(t); label = FREE;}
   61 :  //    border C22(t = 0, 2 * pi){x = 0.6 + r * cos(t); y = 0.5 + r * sin(t); label = FREE;}
   62 :  //    border C31(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.78 + r * sin(t); label = FREE;}
   63 :  //    border C32(t = 0, 2 * pi){x = 0.2 + r * cos(t); y = 0.78 + r * sin(t); label = FREE;}
   64 : 
   65 :  //    Sh = buildmesh(L11(20 * np) + L21(5 * np) + L22(1 * np) + L23(5 * np) + L31(20 * np) + L41(1 * np) + L42(8 * np) + L43(1 * np)
   66 :  //                    + C11(-10 * np) + C12(-10 * np)  + C21(-10 * np) + C22(-10 * np) + C31(-10 * np) + C32(-10 * np));
   67 : 
   68 : 
   69 : //this is case 3
   70 : 
   71 : 	 // real r = 0.2;                                                 
   72 : 
   73 :   //   border L11(t = 0.0, 1.0){x = t; y = 0.0; label = FREE;}
   74 :   //   border L21(t = 0.0, 0.2){x = 1.0; y = t; label = LOAD;}
   75 :   //   border L22(t = 0.2, 0.8){x = 1.0; y = t; label = FREE;}
   76 :   //   border L23(t = 0.8, 1.0){x = 1.0; y = t; label = LOAD;}
   77 :   //   border L31(t = 1.0, 0.0){x = t; y = 1.0; label = FREE;}
   78 :   //   border L41(t = 1.0, 0.95){x = 0.0; y = t; label = WALL;}
   79 :   //   border L42(t = 0.95, 0.05){x = 0.0; y = t; label = FREE;}
   80 :   //   border L43(t = 0.05, 0.0){x = 0.0; y = t; label = WALL;}
   81 : 
   82 :     
   83 :   //   border C11(t = 0, 2 * pi){x = 0.5 + r * cos(t); y = 0.25 + r * sin(t); label = FREE;}
   84 :   //   border C31(t = 0, 2 * pi){x = 0.5 + r * cos(t); y = 0.75 + r * sin(t); label = FREE;}
   85 : 
   86 :   //   Sh = buildmesh(L11(10 * np) + L21(2 * np) + L22(6 * np) + L23(2 * np) + L31(10 * np) + L41(1 * np) + L42(9 * np) + L43(1 * np)
   87 :   //       + C11(-15 * np) + C31(-15 * np)
   88 :   //       );
   89 : 
   90 : 
   91 : //this is case 4:
   92 : 
   93 : 	 // real r = 0.25;
   94 : 
   95 :   //   border L11(t = -1.0, -0.9){x = t; y = 0; label = FREE;}
   96 :   //   border L12(t = -0.9, -0.2){x = t; y = 0; label = FREE;}
   97 :   //   border L13(t = -0.2, 0.2){x = t; y = 0; label = FREE;}
   98 :   //   border L14(t = 0.2, 0.9){x = t; y = 0; label = FREE;}
   99 :   //   border L15(t = 0.9, 1.0){x = t; y = 0; label = FREE;}
  100 :     
  101 :   //   border L21(t = 0, 1.2){x = 1.0; y = t; label = FREE;}
  102 :   //   border L22(t = 1.0, -1.0){x = t; y = 1.2; label = FREE;}
  103 :   //   border L23(t = 1.2, 0){x = -1.0; y = t; label = FREE;}
  104 :     
  105 :   //   border C10(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.4 + r * sin(t); label = FREE;}
  106 :   //   border C11(t = 0, 2 * pi){x = r * cos(t); y = 0.8 + r * sin(t); label = FREE;}
  107 :   //   border C12(t = 0, 2 * pi){x = 0.6 + r * cos(t); y = 0.4 + r * sin(t); label = FREE;}
  108 : 
  109 :   //   Sh = buildmesh(L11(1 * np) + L12(7 * np) + L13(4 * np) + L14(7 * np) + L15(1 * np) + L21(12 * np) + L22(20 * np) + L23(12 * np) 
  110 :   //       + C10(-15 * np) + C11(-15 * np) + C12(-15 * np) 
  111 :   //       );
  112 : 
  113 : 
  114 : //this is case 5
  115 : real r = 0.05;
  116 : 
  117 :     border L11(t = 0.4, -0.4){x = t; y = 1.2; label = FREE;}
  118 :     border L21(t = 1.2, 0.8){x = -0.4; y = t; label = FREE;}
  119 :     border L31(t = -0.4, -0.35){x = t; y = 0.8; label = LOAD;}
  120 :     border L32(t = -0.35, -0.2){x = t; y = 0.8; label = FREE;}
  121 :     border L41(t = 0.8, 0.0){x = -0.2; y = t; label = FREE;}
  122 :     border L51(t = -0.2, -0.15){x = t; y = 0.0; label = WALL;}
  123 :     border L52(t = -0.15, 0.15){x = t; y = 0.0; label = FREE;}
  124 :     border L53(t = 0.15, 0.2){x = t; y = 0.0; label = WALL;}
  125 :     border L42(t = 0.0, 0.8){x = 0.2; y = t; label = FREE;}
  126 :     border L33(t = 0.2, 0.35){x = t; y = 0.8; label = FREE;}
  127 :     border L34(t = 0.35, 0.4){x = t; y = 0.8; label = LOAD;}
  128 :     border L22(t = 0.8, 1.2){x = 0.4; y = t; label = FREE;}
  129 : 
  130 :     border C1(t = 0, 2 * pi){x = -0.25 + r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  131 :     border C2(t = 0, 2 * pi){x = r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  132 :     border C3(t = 0, 2 * pi){x = 0.25 + r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  133 : 
  134 :     Sh = buildmesh(L11(8 * np) + L21(4 * np) + L31(1 * np) + L32(2 * np) + L41(8 * np) + L51(np) + L52(3 * np) + L53(1 * np) 
  135 :                     + L42(8 * np) + L33(2 * np) + L34(1 * np) + L22(4 * np) + C1(-7 * np) + C2(-7 * np) + C3(-7 * np));
  136 : 
  137 : 
  138 : 
  139 : // 	Th=Sh;
  140 : // 	Thprev=Th;
  141 : 
  142 : 	// cut function used to regularize the gradient shape near singularities
  143 : 	// func cut=1-(x>19.5)*(abs(y)<1.5)-(x<0.5)*(y>1.5)*(y<4.5)-(x<0.5)*(y<-1.5)*(y>-4.5);
  144 : 
  145 : 
  146 : 	func cut=(y < 0.8) ;
  147 : 
  148 : // Material parameters
  149 : 	real E=15.;				//Young Modulus (always positif)
  150 : 	real nu=0.35;				//Poisson ratio (between -1 and 1/2)
  151 : 	real lambda=E*nu/((1.+nu)*(1.-2.*nu));	//Lame Moduli
  152 : 	real mu=E/(2.*(1.+nu));
  153 : 
  154 : //Applied Loads
  155 : 	func g1=50; func g2=0;
  156 : 
  157 : //Definition of the variables and intialization
  158 : 	//Finite elements spaces on the finer mesh Sh
  159 : 		fespace Wh(Sh,P1);  		
  160 : 		fespace WSh(Sh,[P2,P2]);
  161 : 	//Finite elements spaces on the coarse mesh Th
  162 : 		fespace WTh(Th,[P2,P2]);	
  163 : 		
  164 : 	Wh gradient; 			//Gradient
  165 : 	WSh [d1,d2];			//extension field
  166 : 	WSh [theta1,theta2];		//test functions for the extension field
  167 : 	WSh [u1,u2],[v1,v2];		//Displacement and Test functions
  168 : 
  169 : 	//Interpolated Finite elements on the coarse mesh
  170 : 	WTh [D1,D2],[Dprev1,Dprev2]; 
  171 : 	WTh [U1,U2],[Uprev1,Uprev2];
  172 : 
  173 : 	int nsaved=0;			//Initialization counter of the back-up copies
  174 : 	int nsave0=100;			//Current number of back-up copies
  175 : 	real compliance;		//Compliance
  176 : 	real volume;
 *** Warning  The identifier volume hide a Global identifier  
			//Volume of the current shape
  177 : 	real perimeter;			//Perimeter of the optimized boundary
  178 : 	string caption;			//Caption for graphic outputs
  179 : 	real GradNorm;			//Gradient Norm
  180 : 	real GradProduct;		//Scalar product between the current gradient and the previous one
  181 : 	bool rollback=false;		//Did we roll back ?
  182 : 	real actualstep;		//Actual step size
  183 : 	real lagrange;			//Lagrange Multiplier associated to the Volume constraint
  184 : 	real[int] isoval(20);		//isovalue used for graphic outputs
  185 : 
  186 : 	int constrained=1;
  187 : 	if (volume0<0) {constrained=0;};
  188 : 
  189 : /////////////////////////
  190 : // Elasticity Problem  //
  191 : /////////////////////////
  192 : 	problem elasticity([u1,u2],[v1,v2]) =
  193 : 		int2d(Sh)(
  194 :         		2.*mu*(dx(u1)*dx(v1)+dy(u2)*dy(v2)+((dx(u2)+dy(u1))*(dx(v2)+dy(v1)))/2.)
  195 :               		+lambda*(dx(u1)+dy(u2))*(dx(v1)+dy(v2)))
  196 : 		-int1d(Sh,neumann)(g1*v1+g2*v2)	           
  197 :     	+on(FREE,u1=0,u2=0);
  198 : 
  199 : ////////////////////////////////////////
  200 : // Expression of the shape's Gradient //
  201 : ////////////////////////////////////////
  202 : 	macro gradientexp()
  203 # 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 # //
  205 : 
  206 : ///////////////////////
  207 : // Extension Problem //
  208 : ///////////////////////
  209 : //  H1 scalar product between vector-valued functions
  210 : 	macro prodscal(t1,t2,p1,p2)
  211 # 		dx(t1)*dx(p1)+dy(t1)*dy(p1)+dx(t2)*dx(p2)+dy(t2)*dy(p2)+t1*p1+t2*p2
  212 #  )  //
  213 : 	problem extension([d1,d2],[theta1,theta2]) =
  214 : 		int2d(Sh)(prodscal(d1,d2,theta1,theta2)
  211 @ 		
  212 @ 
  211 @ 		dx(d1)*dx(theta1)+dy(d1)*dy(theta1)+dx(d2)*dx(theta2)+dy(d2)*dy(theta2)+d1*theta1+d2*theta2
  212 @ )
  215 : 		+int1d(Sh,free) ((theta1*N.x+theta2*N.y)*(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @  + lagrange*constrained)*cut)
  216 : 	  +on(WALL,d1=0,d2=0);
  217 : 
  218 : //////////////////////////////
  219 : //      Initialization      //
  220 : //////////////////////////////
  221 : int iter,iter0;
  222 : string  backupnameNb;
  223 : if(!tocontinue){
  224 : 	iter0=1;
  225 : 	if (volume0==0) {volume0=int1d(Sh)(x*N.x+y*N.y)/2;}	// Computation of the initial Volume
  226 : 	elasticity;						// Solving the State Equation
  227 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);		// Initial Compliance
  228 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );				// Computation of the shape derivative
  229 : 
  230 : 	//Evaluation of the Lagrande Multiplier associated to the Volume constraint
  231 : 	lagrange=int1d(Sh,free)(gradient*cut)/int1d(Sh,free)(cut);
  232 : 	gradient=(gradient-lagrange*constrained)*cut;
  233 : 
  234 : 	//Mesh Adaptation
  235 : 		Th=Sh;
  236 : 		[U1,U2]=[u1,u2];   //interpolation of u on the coarse mesh Th
  237 : 		[Uprev1,Uprev2]=[0,0]; Uprev1[]=U1[]; Uprev2[]=U2[];
  238 : 		Sh=adaptmesh (Th,Uprev1,Uprev2,err=errelas);
  239 : 		actualstep=initialstep;			//Initialization of the initial step
  240 : 
  241 : 	//We save the intial shape
  242 : 	if (nsave!=0) {
  243 : 		//isovalue for graphic output
  244 : 			real gmax=gradient[].max;
  245 : 			real gmin=gradient[].min;
  246 : 			for (int j=0;j<isoval.n;j++) isoval[j]=gmin+(gmax-gmin)/isoval.n*j;
  247 : 		caption="Initial shape, Compliance "+compliance+", Volume "+volume0;
  248 : 		backupnameNb=backupname+nsaved;
  249 : 		plot(gradient,fill=1,value=1,cmm=caption,viso=isoval,ps= "output/"+backupnameNb+".eps");};}
  250 : else {
  251 : // We recover the datas of a previous computation
  252 : 	// Updating of the meshs if we continue a previous computation
  253 : 		Sh=readmesh(backupname+".msh");
  254 : 		Th=readmesh(backupname+"-geo.msh");
  255 : 		Shprev=readmesh(backupname+"-prev.msh");
  256 : 		Thprev=readmesh(backupname+"-geo-prev.msh");
  257 : 	ifstream f(backupname+".txt");
  258 : 	if (volume0==0) {f >>volume0;} else {real next; f >>next;};
  259 : 	f >>lagrange;		//Lagrange Multiplier
  260 : 	f >>actualstep;		//Actual step size
  261 : 	f >>rollback;		//Did we roll back ?
  262 : 	f >>iter0;		//iteration de départ
  263 : 	f >>nsave0;		//Number of previous back-up copies
  264 : 	f >>isoval;
  265 : 	f >>Dprev1[];f>>Dprev2[];//Previous extenstion fields
  266 : 	nsaved=nsave0; 
  267 : 	nsave0=nsave0+1;};
  268 : 
  269 : /////////////////////////////////////
  270 : // Initialization of the Algorithm //
  271 : /////////////////////////////////////
  272 : 	elasticity;					//Solving the state equation
  273 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);	//Initial compliance
  274 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );			//Computation of the shape derivative
  275 : 	//Evaluation of the Lagrange Multiplier associated to the Volume constraint
  276 : 	lagrange=int1d(Sh,free)(gradient*cut)/int1d(Sh,free)(cut);
  277 : 	gradient=(gradient-lagrange*constrained)*cut;
  278 : 
  279 : ///////////////////////////////
  280 : //     Optimization Loop     //
  281 : ///////////////////////////////
  282 : for (iter=iter0;iter< niter+iter0;iter=iter+1){
  283 : 	cout <<"Iteration " <<iter <<" ----------------------------------------" <<endl;
  284 : 
  285 : 	////////////////////////////
  286 : 	// Gradient's Computation //
  287 : 	////////////////////////////
  288 : 	elasticity;
  289 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);
  290 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ )*cut;
  291 : 	cout<<"Compliance :"<<compliance<<"-------------------------------------"<<endl;
  292 : 
  293 : 	[U1,U2]=[u1,u2];  //interpolation of u on the coarse mesh
  294 : 
  295 : 	//Update of the lagrange multiplier
  296 : 		volume=int1d(Sh)(x*N.x+y*N.y)/2;
  297 : 		perimeter=int1d(Sh,free)(cut);
  298 : 		lagrange=0.5*lagrange+0.5*int1d(Sh,free)(gradient)/perimeter
  299 : 		+lagrangestep*(volume-volume0)/volume0;
  300 : 	gradient=gradient-lagrange*constrained*cut;
  301 : 	
  302 : 	/////////////////////
  303 : 	// Graphic Outputs //
  304 : 	/////////////////////
  305 : 	//isovalues
  306 : 		real gmax=gradient[].max;
  307 : 		for (int j=0;j<isoval.n;j++) 
  308 : 		isoval[j]=isoval[j]*(0.7*isoval[isoval.n-1]+0.3*gmax)/isoval[isoval.n-1];
  309 : 	caption="Iteration "+iter+", Compliance="+compliance+", Volume="+volume;
  310 : 	backupnameNb="output/"+backupname+nsaved+".eps";
  311 : 	plot(gradient,fill=1,value=1,cmm=caption,viso=isoval);
  312 : 	
  313 : 	/////////////////////////
  314 : 	// Back-up Iterations  //
  315 : 	/////////////////////////
  316 : 	if ((nsaved-nsave0)*niter<(iter-iter0-1)*nsave) {
  317 : 	nsaved=nsaved+1;
  318 : 	caption="Iteration "+iter+", Compliance ="+compliance+", Volume="+volume;
  319 : 	backupnameNb="output/"+backupname+nsaved+".eps";
  320 : 	plot(gradient,fill=1,value=1,cmm=caption,viso=isoval,ps=backupnameNb);
  321 : 	savemesh(Sh,backupname+".msh");};
  322 : 
  323 : 	///////////////////////////////
  324 : 	// Modification of the shape //
  325 : 	///////////////////////////////
  326 : 	extension;		//Computation of the field [d1,d2]
  327 : 	[D1,D2]=[d1,d2];	//Interpolation on the coarse mesh
  328 : 
  329 : 	////////////////////////////////////
  330 : 	// Updating the step              //
  331 : 	////////////////////////////////////
  332 : 	GradNorm=int2d(Th)(prodscal(D1,D2,D1,D2)
  211 @ 		
  212 @ 
  211 @ 		dx(D1)*dx(D1)+dy(D1)*dy(D1)+dx(D2)*dx(D2)+dy(D2)*dy(D2)+D1*D1+D2*D2
  212 @ );
  333 : 	GradProduct=int2d(Th)(prodscal(D1,D2,Dprev1,Dprev2)
  211 @ 		
  212 @ 
  211 @ 		dx(D1)*dx(Dprev1)+dy(D1)*dy(Dprev1)+dx(D2)*dx(Dprev2)+dy(D2)*dy(Dprev2)+D1*Dprev1+D2*Dprev2
  212 @ );
  334 : 	if ((GradProduct<0.)&(!rollback)) {
  335 : 		actualstep=actualstep*GradNorm/(GradNorm-GradProduct)/4.; 
  336 :                 cout<<"Step too big: we step back !!!"<<endl; Th=Thprev; Sh=Shprev; rollback=true;}
  337 : 	else 
  338 : 		rollback=false;
  339 : 	if ((GradProduct>0.)&(GradProduct<(GradNorm/2.))){
  340 : 		actualstep=actualstep*2.*GradNorm/(2.*GradNorm-GradProduct); 
  341 :                 cout<<"We increase the step size"<<endl;};
  342 : 	if (GradProduct>(GradNorm/2.)){
  343 : 		actualstep=actualstep*4./3.;
  344 : 		cout<<"We increase the step size"<<endl;};
  345 : 	if(maxstep>0.) 
  346 : 		actualstep=min(actualstep,maxstep);
  347 : 	Thprev=Th;	//We keep a copy of the meshs (in case of backup at the next loop's step)
  348 : 	Shprev=Sh;
  349 : 
  350 : 	//////////////////////////////////
  351 : 	// We move the coarse mesh Th   //
  352 : 	//////////////////////////////////
  353 : 	if (!rollback){
  354 : 		real aa,minaire=checkmovemesh (Th,[x,y])/10000.;
  355 : 		while (minaire > (aa=checkmovemesh(Th,[x+actualstep*D1,y+actualstep*D2])) ){
  356 :   			cout << " problem reversed triangle  => actualstep= actual
  ... : step/2. "<<endl; 
  357 : 			actualstep= actualstep/2.;
  358 : 					}
  359 : 		Th = movemesh (Th,[x+actualstep*D1,y+actualstep*D2]);
  360 : 		cout<<"Mesh moved"<<endl;
  361 : 		cout<<"Actual Step "<<actualstep<<"------------------------------------"<<endl;
  362 : 		[Dprev1,Dprev2]=[0,0];
  363 : 		Dprev1[]=D1[];Dprev2[]=D2[];
  364 : 		[Uprev1,Uprev2]=[0,0]; Uprev1[]=U1[]; Uprev2[]=U2[]; //Interpolation of u on the new mesh Th
  365 : 		};
  366 : 
  367 : 	//////////////////////
  368 : 	// Mesh Adaptation  //
  369 : 	//////////////////////
  370 : 	if (rollback){Sh=Shprev; } 		//We step back
  371 : 	else {
  372 : 		cout<<"Mesh adaptation of Sh"<<endl;
  373 : 		Sh=adaptmesh(Th,Uprev1,Uprev2,[Dprev1,Dprev2],err=errelas);
  374 : 		plot(Sh,wait=0);
  375 : 		cout<<"Mesh adaptation of the coarse mesh Th"<<endl;
  376 : 		Th=adaptmesh(Sh,metricmsh,0,metricmsh,IsMetric=1,ratio=0,omega=200,splitpbedge=1,hmin=0.05,abserror=1); }
  377 : 	cout<<"Mesh adaptation done"<<endl;
  378 : };
  379 : ///// END OF THE OPTIMIZATION LOOP /////
  380 : 
  381 : // Back-up    ///////////////////////////////////////////////
  382 : if (nsave!=0) {
  383 : 	//We save the meshes
  384 : 		savemesh(Sh,backupname+".msh");
  385 : 		savemesh(Shprev,backupname+"-prev.msh");
  386 : 		savemesh(Th,backupname+"-geo.msh");
  387 : 		savemesh(Th,backupname+"-geo-prev.msh");
  388 : 	//We save all variables
  389 : 		{ofstream f(backupname+".txt");
  390 : 		f << volume0<<"\n";	//Initial Volume
  391 : 		f <<lagrange<<"\n";	//Lagrange Multiplier
  392 : 		f <<actualstep<<"\n";	//Actual step
  393 : 		f <<rollback<<"\n";	//boolean variable
  394 : 		f <<iter<<"\n";		//Current Iteration
  395 : 		f <<nsaved+1<<"\n";	//Number of back-up done
  396 : 		f <<isoval<<"\n";
  397 : 		[Dprev1,Dprev2]=[Dprev1,Dprev2];
  398 : 		f <<Dprev1[]<<endl;f<<Dprev2[]<<endl;};
  399 : 	nsaved=nsaved+1;
  400 : 	elasticity;
  401 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );
  402 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);
  403 : 	cout<<"Compliance : "<<compliance<<"-------------------------------------"<<endl;
  404 : 	gradient=gradient*cut;
  405 : 	volume=int2d(Sh)(1.);
  406 : 	perimeter=int1d(Sh,free)(cut);
  407 : 	lagrange=0.5*lagrange+0.5*int1d(Sh,free)(gradient)/perimeter+lagrangestep*(volume-volume0)/volume0;
  408 : 	gradient=gradient-lagrange*constrained*cut;
  409 : 	//Graphic output of the gradient
  410 : 		caption="Iteration "+iter+", Compliance ="+compliance+", Volume="+volume;
  411 : 		backupnameNb=backupname+nsaved+".eps";
  412 : 		plot(gradient,fill=1,value=0,cmm=caption,viso=isoval,ps="output/"+ backupnameNb);
  413 : };
  414 :  sizestack + 1024 =11480  ( 10456 )

  --  mesh:  Nb of Triangles =  23310, Nb of Vertices 11973
  -- Solve : 
          min -0.0270812  max 0.110227
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 3318 , h  min 0.000782225 , h max 0.206922
     area =  0.616643 , M area = 1447.86 , M area/( |Khat| nt) 1.00775
     infiny-regularity:  min 0.365827  max 2.20857
     anisomax  6.89393, beta max = 1.25717 min  0.739221
  --  mesh:  Nb of Triangles =   3318, Nb of Vertices 1803
 Err opening postscript file output/output0.eps
  -- Solve : 
          min -0.0282512  max 0.112391
Iteration 1 ----------------------------------------
  -- Solve : 
          min -0.0282512  max 0.112391
Compliance :0.418111-------------------------------------
 Err opening postscript file output/output1.eps
  number of required edges : 0
  -- Solve : 
          min -3.53794  max 2.55829
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00625------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 4537 , h  min 0.000809328 , h max 0.0907017
     area =  0.59328 , M area = 1989.28 , M area/( |Khat| nt) 1.01257
     infiny-regularity:  min 0.383547  max 2.61011
     anisomax  4.0791, beta max = 1.25464 min  0.687323
  --  mesh:  Nb of Triangles =   4537, Nb of Vertices 2445
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 307 , h  min 0.00514273 , h max 0.39994
     area =  0.597018 , M area = 5.52469 , M area/( |Khat| nt) 0.0415594
     infiny-regularity:  min 0.00261926  max 3.277
     anisomax  45.4676, beta max = 107.265 min  0.973314
  --  mesh:  Nb of Triangles =    307, Nb of Vertices 200
Mesh adaptation done
Iteration 2 ----------------------------------------
  -- Solve : 
          min -0.02864  max 0.119727
Compliance :0.458633-------------------------------------
 Err opening postscript file output/output2.eps
  number of required edges : 0
  -- Solve : 
          min -3.85406  max 3.86363
We increase the step size
Mesh moved
Actual Step 0.00833333------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2529 , h  min 0.00131166 , h max 0.0886561
     area =  0.551173 , M area = 1111.07 , M area/( |Khat| nt) 1.0146
     infiny-regularity:  min 0.192687  max 2.92137
     anisomax  8.06195, beta max = 2.07478 min  0.761432
  --  mesh:  Nb of Triangles =   2529, Nb of Vertices 1383
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 298 , h  min 0.00471234 , h max 0.399576
     area =  0.556303 , M area = 5.32895 , M area/( |Khat| nt) 0.0412976
     infiny-regularity:  min 0.00241543  max 3.50117
     anisomax  37.7982, beta max = 118.197 min  1.0912
  --  mesh:  Nb of Triangles =    298, Nb of Vertices 194
Mesh adaptation done
Iteration 3 ----------------------------------------
  -- Solve : 
          min -0.0292177  max 0.12061
Compliance :0.460649-------------------------------------
 Err opening postscript file output/output3.eps
  number of required edges : 0
  -- Solve : 
          min -3.59302  max 3.70642
We increase the step size
Mesh moved
Actual Step 0.0111111------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2320 , h  min 0.00127721 , h max 0.0965845
     area =  0.505431 , M area = 1008.03 , M area/( |Khat| nt) 1.00342
     infiny-regularity:  min 0.183168  max 3.3969
     anisomax  11.1914, beta max = 2.06808 min  0.758647
  --  mesh:  Nb of Triangles =   2320, Nb of Vertices 1274
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 295 , h  min 0.00551427 , h max 0.39886
     area =  0.505318 , M area = 3.15257 , M area/( |Khat| nt) 0.0246798
     infiny-regularity:  min 0.00215521  max 4.31692
     anisomax  39.6293, beta max = 128.191 min  1.62652
  --  mesh:  Nb of Triangles =    295, Nb of Vertices 192
Mesh adaptation done
Iteration 4 ----------------------------------------
  -- Solve : 
          min -0.0276989  max 0.11637
Compliance :0.435823-------------------------------------
 Err opening postscript file output/output4.eps
  number of required edges : 0
  -- Solve : 
          min -2.5211  max 3.23506
We increase the step size
Mesh moved
Actual Step 0.0148148------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2180 , h  min 0.0014624 , h max 0.129261
     area =  0.46379 , M area = 950.607 , M area/( |Khat| nt) 1.00703
     infiny-regularity:  min 0.141458  max 2.43713
     anisomax  9.50198, beta max = 2.22731 min  0.75305
  --  mesh:  Nb of Triangles =   2180, Nb of Vertices 1203
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00518687 , h max 0.405549
     area =  0.463792 , M area = 2.88836 , M area/( |Khat| nt) 0.0230809
     infiny-regularity:  min 0.00196084  max 4.27006
     anisomax  40.848, beta max = 137.073 min  1.7616
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 5 ----------------------------------------
  -- Solve : 
          min -0.0254102  max 0.110456
Compliance :0.413431-------------------------------------
 Err opening postscript file output/output5.eps
  number of required edges : 0
  -- Solve : 
          min -1.69548  max 2.48146
We increase the step size
Mesh moved
Actual Step 0.0197531------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1786 , h  min 0.00224075 , h max 0.114519
     area =  0.432636 , M area = 776.027 , M area/( |Khat| nt) 1.00345
     infiny-regularity:  min 0.14943  max 1.96234
     anisomax  9.47742, beta max = 2.32384 min  0.779969
  --  mesh:  Nb of Triangles =   1786, Nb of Vertices 1001
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00499305 , h max 0.4239
     area =  0.432483 , M area = 2.71334 , M area/( |Khat| nt) 0.0216823
     infiny-regularity:  min 0.00183176  max 2.09821
     anisomax  40.3557, beta max = 145.904 min  1.87077
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 6 ----------------------------------------
  -- Solve : 
          min -0.0252857  max 0.108187
Compliance :0.402451-------------------------------------
 Err opening postscript file output/output6.eps
  number of required edges : 0
  -- Solve : 
          min -1.05656  max 2.01447
We increase the step size
Mesh moved
Actual Step 0.0263374------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1574 , h  min 0.00224115 , h max 0.117722
     area =  0.414896 , M area = 674.584 , M area/( |Khat| nt) 0.989762
     infiny-regularity:  min 0.12324  max 2.0348
     anisomax  18.0659, beta max = 2.50284 min  0.753392
  --  mesh:  Nb of Triangles =   1574, Nb of Vertices 897
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00491766 , h max 0.44723
     area =  0.414575 , M area = 2.33121 , M area/( |Khat| nt) 0.0186287
     infiny-regularity:  min 0.00154583  max 2.10501
     anisomax  86.7424, beta max = 153.147 min  1.95422
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 7 ----------------------------------------
  -- Solve : 
          min -0.023999  max 0.123402
Compliance :0.422003-------------------------------------
 Err opening postscript file output/output7.eps
  number of required edges : 0
  -- Solve : 
          min -1.49584  max 1.64176
We increase the step size
Mesh moved
Actual Step 0.0351166------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1455 , h  min 0.00173875 , h max 0.117729
     area =  0.399749 , M area = 624.126 , M area/( |Khat| nt) 0.990624
     infiny-regularity:  min 0.126445  max 2.02783
     anisomax  13.5263, beta max = 2.76353 min  0.803137
  --  mesh:  Nb of Triangles =   1455, Nb of Vertices 838
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00488729 , h max 0.470463
     area =  0.399378 , M area = 2.21114 , M area/( |Khat| nt) 0.0176692
     infiny-regularity:  min 0.00154304  max 2.85949
     anisomax  40.453, beta max = 156.983 min  1.97703
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 8 ----------------------------------------
  -- Solve : 
          min -0.0246597  max 0.112558
Compliance :0.41187-------------------------------------
 Err opening postscript file output/output8.eps
  number of required edges : 0
  -- Solve : 
          min -0.724551  max 1.38324
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0234111------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1318 , h  min 0.00196679 , h max 0.119898
     area =  0.392538 , M area = 559.584 , M area/( |Khat| nt) 0.980504
     infiny-regularity:  min 0.121772  max 2.41292
     anisomax  23.7272, beta max = 2.63418 min  0.74992
  --  mesh:  Nb of Triangles =   1318, Nb of Vertices 769
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.0048805 , h max 0.48493
     area =  0.392121 , M area = 2.20603 , M area/( |Khat| nt) 0.0176284
     infiny-regularity:  min 0.00154594  max 3.17947
     anisomax  87.4087, beta max = 158.305 min  1.97516
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 9 ----------------------------------------
  -- Solve : 
          min -0.0247937  max 0.106177
Compliance :0.38396-------------------------------------
 Err opening postscript file output/output9.eps
  number of required edges : 0
  -- Solve : 
          min -0.791616  max 2.03901
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00323487------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1337 , h  min 0.00062631 , h max 0.133926
     area =  0.391069 , M area = 557.636 , M area/( |Khat| nt) 0.963204
     infiny-regularity:  min 0.0935809  max 2.21662
     anisomax  169.675, beta max = 2.98782 min  0.773066
  --  mesh:  Nb of Triangles =   1337, Nb of Vertices 777
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487958 , h max 0.487466
     area =  0.390641 , M area = 2.23047 , M area/( |Khat| nt) 0.0178237
     infiny-regularity:  min 0.00154573  max 3.51428
     anisomax  338.534, beta max = 158.592 min  1.90197
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 10 ----------------------------------------
  -- Solve : 
          min -0.0249489  max 0.107393
Compliance :0.375945-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.35723  max 1.22344
We increase the step size
Mesh moved
Actual Step 0.00414367------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1324 , h  min 0.00170982 , h max 0.114864
     area =  0.390322 , M area = 563.587 , M area/( |Khat| nt) 0.983042
     infiny-regularity:  min 0.135579  max 2.33898
     anisomax  43.3535, beta max = 2.61102 min  0.701892
  --  mesh:  Nb of Triangles =   1324, Nb of Vertices 772
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487838 , h max 0.489539
     area =  0.389885 , M area = 2.23438 , M area/( |Khat| nt) 0.017855
     infiny-regularity:  min 0.00154561  max 3.63025
     anisomax  93.5135, beta max = 158.811 min  1.87891
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 11 ----------------------------------------
  -- Solve : 
          min -0.0250298  max 0.105641
Compliance :0.37898-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -0.833991  max 1.57408
We increase the step size
Mesh moved
Actual Step 0.00518092------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1294 , h  min 0.00187565 , h max 0.118807
     area =  0.388328 , M area = 547.306 , M area/( |Khat| nt) 0.976776
     infiny-regularity:  min 0.0819972  max 2.39776
     anisomax  145.999, beta max = 2.85577 min  0.693745
  --  mesh:  Nb of Triangles =   1294, Nb of Vertices 755
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487733 , h max 0.492943
     area =  0.387881 , M area = 2.23098 , M area/( |Khat| nt) 0.0178278
     infiny-regularity:  min 0.00154633  max 3.68571
     anisomax  137.956, beta max = 159.145 min  1.86903
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 12 ----------------------------------------
  -- Solve : 
          min -0.0241865  max 0.103574
Compliance :0.374995-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.23849  max 0.886687
We increase the step size
Mesh moved
Actual Step 0.0069079------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1282 , h  min 0.00198381 , h max 0.136746
     area =  0.387994 , M area = 548.553 , M area/( |Khat| nt) 0.988165
     infiny-regularity:  min 0.102276  max 2.18682
     anisomax  25.8307, beta max = 2.8717 min  0.772022
  --  mesh:  Nb of Triangles =   1282, Nb of Vertices 749
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487588 , h max 0.494791
     area =  0.38754 , M area = 2.24279 , M area/( |Khat| nt) 0.0179221
     infiny-regularity:  min 0.00154575  max 3.96631
     anisomax  85.8556, beta max = 159.34 min  1.81668
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 13 ----------------------------------------
  -- Solve : 
          min -0.0249077  max 0.107385
Compliance :0.383991-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -0.895835  max 1.10105
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00360214------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1154 , h  min 0.000628764 , h max 0.137901
     area =  0.386749 , M area = 478.142 , M area/( |Khat| nt) 0.956865
     infiny-regularity:  min 0.100446  max 2.25647
     anisomax  136.796, beta max = 3.23429 min  0.706054
  --  mesh:  Nb of Triangles =   1154, Nb of Vertices 683
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487544 , h max 0.495904
     area =  0.386299 , M area = 2.18399 , M area/( |Khat| nt) 0.0174522
     infiny-regularity:  min 0.00140293  max 2.94181
     anisomax  384.692, beta max = 159.44 min  1.9935
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 14 ----------------------------------------
  -- Solve : 
          min -0.0246382  max 0.104505
Compliance :0.36541-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.70323  max 2.16877
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000271147------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1142 , h  min 0.000318369 , h max 0.136949
     area =  0.386587 , M area = 457.309 , M area/( |Khat| nt) 0.92479
     infiny-regularity:  min 0.0123043  max 2.17452
     anisomax  200.859, beta max = 28.6842 min  0.774031
  --  mesh:  Nb of Triangles =   1142, Nb of Vertices 676
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487539 , h max 0.496032
     area =  0.386141 , M area = 2.1738 , M area/( |Khat| nt) 0.0173708
     infiny-regularity:  min 0.000676886  max 2.63233
     anisomax  797.583, beta max = 159.451 min  1.99363
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 15 ----------------------------------------
  -- Solve : 
          min -0.0245539  max 0.10569
Compliance :0.368159-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.51662  max 2.57823
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.000180765------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1159 , h  min 0.00147422 , h max 0.145272
     area =  0.386476 , M area = 467.846 , M area/( |Khat| nt) 0.932221
     infiny-regularity:  min 0.00695541  max 2.14664
     anisomax  1171.7, beta max = 14.0358 min  0.695083
  --  mesh:  Nb of Triangles =   1159, Nb of Vertices 685
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487536 , h max 0.496151
     area =  0.386025 , M area = 2.17372 , M area/( |Khat| nt) 0.0173702
     infiny-regularity:  min 9.34732e-05  max 2.65245
     anisomax  5777.46, beta max = 159.464 min  1.99374
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 16 ----------------------------------------
  -- Solve : 
          min -0.0244499  max 0.105118
Compliance :0.365638-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.35492  max 1.56677
We increase the step size
Mesh moved
Actual Step 0.00024079------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1288 , h  min 0.00151317 , h max 0.138879
     area =  0.386419 , M area = 553.21 , M area/( |Khat| nt) 0.991913
     infiny-regularity:  min 0.0228344  max 2.38417
     anisomax  300.923, beta max = 6.37132 min  0.710759
  --  mesh:  Nb of Triangles =   1288, Nb of Vertices 752
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487529 , h max 0.496295
     area =  0.385957 , M area = 2.24602 , M area/( |Khat| nt) 0.0179479
     infiny-regularity:  min 0.000365347  max 4.18792
     anisomax  1478.91, beta max = 159.48 min  1.77846
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 17 ----------------------------------------
  -- Solve : 
          min -0.0244134  max 0.10511
Compliance :0.366822-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.89263  max 4.54285
Step too big: we step back !!!
Mesh adaptation done
Iteration 18 ----------------------------------------
  -- Solve : 
          min -0.0244499  max 0.105118
Compliance :0.365638-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.35795  max 1.51772
We increase the step size
Mesh moved
Actual Step 5.96387e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1318 , h  min 0.00166551 , h max 0.138884
     area =  0.38647 , M area = 556.289 , M area/( |Khat| nt) 0.974731
     infiny-regularity:  min 0.00999951  max 2.35452
     anisomax  883.411, beta max = 9.62055 min  0.705061
  --  mesh:  Nb of Triangles =   1318, Nb of Vertices 767
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487534 , h max 0.496186
     area =  0.386009 , M area = 2.2465 , M area/( |Khat| nt) 0.0179518
     infiny-regularity:  min 0.000160026  max 4.21392
     anisomax  3375.1, beta max = 159.467 min  1.77404
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 19 ----------------------------------------
  -- Solve : 
          min -0.024501  max 0.105236
Compliance :0.366536-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.24681  max 7.79857
Step too big: we step back !!!
Mesh adaptation done
Iteration 20 ----------------------------------------
  -- Solve : 
          min -0.0244499  max 0.105118
Compliance :0.365638-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.37027  max 1.318
We increase the step size
Mesh moved
Actual Step 1.64853e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1330 , h  min 0.00146046 , h max 0.138885
     area =  0.386482 , M area = 557.798 , M area/( |Khat| nt) 0.968556
     infiny-regularity:  min 0.00820162  max 2.39273
     anisomax  986.534, beta max = 12.768 min  0.748382
  --  mesh:  Nb of Triangles =   1330, Nb of Vertices 773
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.24747 , M area/( |Khat| nt) 0.0179596
     infiny-regularity:  min 0.000110996  max 4.22222
     anisomax  4865.53, beta max = 159.465 min  1.77264
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 21 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92487  max 1.48546
We increase the step size
Mesh moved
Actual Step 2.19804e-05------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1146 , h  min 0.00165773 , h max 0.141062
     area =  0.386471 , M area = 464.833 , M area/( |Khat| nt) 0.936724
     infiny-regularity:  min 0.0106962  max 2.19042
     anisomax  823.191, beta max = 9.33115 min  0.766741
  --  mesh:  Nb of Triangles =   1146, Nb of Vertices 679
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.49617
     area =  0.38602 , M area = 2.1707 , M area/( |Khat| nt) 0.017346
     infiny-regularity:  min 0.000170622  max 2.65102
     anisomax  3165.32, beta max = 159.465 min  1.99376
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 22 ----------------------------------------
  -- Solve : 
          min -0.0247943  max 0.10512
Compliance :0.366045-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.04802  max 7.58272
Step too big: we step back !!!
Mesh adaptation done
Iteration 23 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.93689  max 1.50766
We increase the step size
Mesh moved
Actual Step 5.786e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1152 , h  min 0.00167344 , h max 0.141397
     area =  0.386472 , M area = 473.4 , M area/( |Khat| nt) 0.949019
     infiny-regularity:  min 0.00453341  max 2.71152
     anisomax  1887.69, beta max = 10.7911 min  0.742766
  --  mesh:  Nb of Triangles =   1152, Nb of Vertices 682
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496162
     area =  0.386021 , M area = 2.17329 , M area/( |Khat| nt) 0.0173668
     infiny-regularity:  min 0.000126851  max 2.66483
     anisomax  4257.44, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 24 ----------------------------------------
  -- Solve : 
          min -0.0245407  max 0.104657
Compliance :0.363845-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.55945  max 6.82981
Step too big: we step back !!!
Mesh adaptation done
Iteration 25 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92799  max 1.49122
We increase the step size
Mesh moved
Actual Step 1.5849e-06------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1144 , h  min 0.00176322 , h max 0.141151
     area =  0.386472 , M area = 467.795 , M area/( |Khat| nt) 0.944341
     infiny-regularity:  min 0.0087401  max 2.23372
     anisomax  964.006, beta max = 12.4451 min  0.781945
  --  mesh:  Nb of Triangles =   1144, Nb of Vertices 678
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.49616
     area =  0.386022 , M area = 2.17377 , M area/( |Khat| nt) 0.0173706
     infiny-regularity:  min 0.000115308  max 2.65536
     anisomax  4683.57, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 26 ----------------------------------------
  -- Solve : 
          min -0.0246646  max 0.104655
Compliance :0.362696-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.19823  max 3.40224
Step too big: we step back !!!
Mesh adaptation done
Iteration 27 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92682  max 1.48907
We increase the step size
Mesh moved
Actual Step 3.9741e-07------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1152 , h  min 0.00176225 , h max 0.141119
     area =  0.386472 , M area = 466.389 , M area/( |Khat| nt) 0.934965
     infiny-regularity:  min 0.00849477  max 2.20894
     anisomax  991.791, beta max = 12.6222 min  0.737529
  --  mesh:  Nb of Triangles =   1152, Nb of Vertices 682
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17376 , M area/( |Khat| nt) 0.0173706
     infiny-regularity:  min 0.000112076  max 2.65408
     anisomax  4818.63, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 28 ----------------------------------------
  -- Solve : 
          min -0.0245353  max 0.104605
Compliance :0.362716-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.18516  max 3.34835
Step too big: we step back !!!
Mesh adaptation done
Iteration 29 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.91549  max 1.46813
We increase the step size
Mesh moved
Actual Step 9.9482e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1147 , h  min 0.00175723 , h max 0.140789
     area =  0.386468 , M area = 459.569 , M area/( |Khat| nt) 0.925308
     infiny-regularity:  min 0.00843339  max 2.40618
     anisomax  998.708, beta max = 12.6754 min  0.65022
  --  mesh:  Nb of Triangles =   1147, Nb of Vertices 679
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.1732 , M area/( |Khat| nt) 0.017366
     infiny-regularity:  min 0.000111266  max 2.64041
     anisomax  4853.7, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 30 ----------------------------------------
  -- Solve : 
          min -0.0247222  max 0.105155
Compliance :0.3649-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.18374  max 3.38683
Step too big: we step back !!!
Mesh adaptation done
Iteration 31 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.93041  max 1.4957
We increase the step size
Mesh moved
Actual Step 2.4924e-08------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1138 , h  min 0.00176361 , h max 0.141226
     area =  0.386472 , M area = 470.843 , M area/( |Khat| nt) 0.955506
     infiny-regularity:  min 0.00841772  max 2.31171
     anisomax  1000.9, beta max = 12.6769 min  0.773082
  --  mesh:  Nb of Triangles =   1138, Nb of Vertices 675
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17323 , M area/( |Khat| nt) 0.0173663
     infiny-regularity:  min 0.000111064  max 2.65812
     anisomax  4862.54, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 32 ----------------------------------------
  -- Solve : 
          min -0.024602  max 0.104753
Compliance :0.362723-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.30936  max 3.51628
Step too big: we step back !!!
Mesh adaptation done
Iteration 33 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.91233  max 1.46228
We increase the step size
Mesh moved
Actual Step 6.27834e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1133 , h  min 0.00175577 , h max 0.140689
     area =  0.386468 , M area = 457.356 , M area/( |Khat| nt) 0.932231
     infiny-regularity:  min 0.0084147  max 2.18156
     anisomax  1000.87, beta max = 29.2636 min  0.787543
  --  mesh:  Nb of Triangles =   1133, Nb of Vertices 672
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.17362 , M area/( |Khat| nt) 0.0173694
     infiny-regularity:  min 0.000111011  max 2.63627
     anisomax  4864.85, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 34 ----------------------------------------
  -- Solve : 
          min -0.0246285  max 0.104988
Compliance :0.363136-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.1098  max 3.25145
Step too big: we step back !!!
Mesh adaptation done
Iteration 35 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92626  max 1.48802
We increase the step size
Mesh moved
Actual Step 1.56287e-09------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1154 , h  min 0.00176186 , h max 0.141103
     area =  0.386472 , M area = 467.137 , M area/( |Khat| nt) 0.934842
     infiny-regularity:  min 0.00841321  max 2.25051
     anisomax  1001.32, beta max = 12.6834 min  0.772756
  --  mesh:  Nb of Triangles =   1154, Nb of Vertices 683
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17367 , M area/( |Khat| nt) 0.0173698
     infiny-regularity:  min 0.000111  max 2.65344
     anisomax  4865.33, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 36 ----------------------------------------
  -- Solve : 
          min -0.0246803  max 0.104715
Compliance :0.364309-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.33333  max 3.52174
Step too big: we step back !!!
Mesh adaptation done
Iteration 37 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.90015  max 1.43978
We increase the step size
Mesh moved
Actual Step 3.94102e-10------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1118 , h  min 0.0017501 , h max 0.20738
     area =  0.386467 , M area = 448.376 , M area/( |Khat| nt) 0.92619
     infiny-regularity:  min 0.00841375  max 2.24161
     anisomax  1000.65, beta max = 12.7019 min  0.806793
  --  mesh:  Nb of Triangles =   1118, Nb of Vertices 663
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.15325 , M area/( |Khat| nt) 0.0172067
     infiny-regularity:  min 0.000110995  max 2.0379
     anisomax  4865.54, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 38 ----------------------------------------
  -- Solve : 
          min -0.0245103  max 0.104948
Compliance :0.363719-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.52011  max 3.85359
Step too big: we step back !!!
Mesh adaptation done
Iteration 39 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92246  max 1.481
We increase the step size
Mesh moved
Actual Step 1.01285e-10------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1160 , h  min 0.00176024 , h max 0.141528
     area =  0.386472 , M area = 464.873 , M area/( |Khat| nt) 0.925498
     infiny-regularity:  min 0.00841281  max 2.20396
     anisomax  1001.28, beta max = 12.686 min  0.75601
  --  mesh:  Nb of Triangles =   1160, Nb of Vertices 686
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17317 , M area/( |Khat| nt) 0.0173659
     infiny-regularity:  min 0.000110997  max 2.64899
     anisomax  4865.48, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 40 ----------------------------------------
  -- Solve : 
          min -0.0248033  max 0.105033
Compliance :0.365703-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.21148  max 3.37793
Step too big: we step back !!!
Mesh adaptation done
Iteration 41 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.91341  max 1.46427
We increase the step size
Mesh moved
Actual Step 2.54074e-11------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1137 , h  min 0.00175625 , h max 0.140724
     area =  0.386468 , M area = 458.992 , M area/( |Khat| nt) 0.932275
     infiny-regularity:  min 0.00841342  max 2.26283
     anisomax  1001.07, beta max = 12.692 min  0.77729
  --  mesh:  Nb of Triangles =   1137, Nb of Vertices 674
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.17367 , M area/( |Khat| nt) 0.0173698
     infiny-regularity:  min 0.000110997  max 2.6377
     anisomax  4865.49, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 42 ----------------------------------------
  -- Solve : 
          min -0.0245658  max 0.104962
Compliance :0.36466-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.12405  max 3.24333
Step too big: we step back !!!
Mesh adaptation done
Iteration 43 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.90771  max 1.45375
We increase the step size
Mesh moved
Actual Step 6.37632e-12------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1138 , h  min 0.00175366 , h max 0.140537
     area =  0.386468 , M area = 454.201 , M area/( |Khat| nt) 0.921733
     infiny-regularity:  min 0.00841344  max 2.20045
     anisomax  1000.88, beta max = 12.6962 min  0.759788
  --  mesh:  Nb of Triangles =   1138, Nb of Vertices 674
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.17322 , M area/( |Khat| nt) 0.0173662
     infiny-regularity:  min 0.000110996  max 2.62997
     anisomax  4865.51, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 44 ----------------------------------------
  -- Solve : 
          min -0.0246718  max 0.104942
Compliance :0.363462-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.1667  max 3.33599
Step too big: we step back !!!
Mesh adaptation done
Iteration 45 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92638  max 1.48825
We increase the step size
Mesh moved
Actual Step 1.6001e-12------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1138 , h  min 0.00176191 , h max 0.141106
     area =  0.386472 , M area = 466.548 , M area/( |Khat| nt) 0.94679
     infiny-regularity:  min 0.00841278  max 2.33315
     anisomax  1001.41, beta max = 12.6833 min  0.73296
  --  mesh:  Nb of Triangles =   1138, Nb of Vertices 675
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17084 , M area/( |Khat| nt) 0.0173472
     infiny-regularity:  min 0.000110995  max 2.65358
     anisomax  4865.58, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 46 ----------------------------------------
  -- Solve : 
          min -0.024733  max 0.105209
Compliance :0.364645-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.27719  max 3.5029
Step too big: we step back !!!
Mesh adaptation done
Iteration 47 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92272  max 1.48148
We increase the step size
Mesh moved
Actual Step 4.00766e-13------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1142 , h  min 0.00176035 , h max 0.141006
     area =  0.386472 , M area = 464.853 , M area/( |Khat| nt) 0.940045
     infiny-regularity:  min 0.00841297  max 2.19753
     anisomax  1001.28, beta max = 12.6859 min  0.776264
  --  mesh:  Nb of Triangles =   1142, Nb of Vertices 677
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17366 , M area/( |Khat| nt) 0.0173697
     infiny-regularity:  min 0.000110997  max 2.6493
     anisomax  4865.45, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 48 ----------------------------------------
  -- Solve : 
          min -0.0247985  max 0.105171
Compliance :0.364227-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.17633  max 3.35308
Step too big: we step back !!!
Mesh adaptation done
Iteration 49 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92149  max 1.47921
We increase the step size
Mesh moved
Actual Step 1.00208e-13------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1150 , h  min 0.00175982 , h max 0.14097
     area =  0.386472 , M area = 462.975 , M area/( |Khat| nt) 0.929736
     infiny-regularity:  min 0.00841271  max 2.47866
     anisomax  1001.24, beta max = 12.6867 min  0.733113
  --  mesh:  Nb of Triangles =   1150, Nb of Vertices 681
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17379 , M area/( |Khat| nt) 0.0173708
     infiny-regularity:  min 0.000110995  max 2.64783
     anisomax  4865.57, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 50 ----------------------------------------
  -- Solve : 
          min -0.0249376  max 0.105063
Compliance :0.364802-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.22316  max 3.3871
Step too big: we step back !!!
Mesh adaptation done
Iteration 51 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.90807  max 1.45441
We increase the step size
Mesh moved
Actual Step 2.52253e-14------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1142 , h  min 0.00175383 , h max 0.140549
     area =  0.386468 , M area = 453.886 , M area/( |Khat| nt) 0.917867
     infiny-regularity:  min 0.00841349  max 2.20216
     anisomax  1000.92, beta max = 12.6958 min  0.743626
  --  mesh:  Nb of Triangles =   1142, Nb of Vertices 676
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.17312 , M area/( |Khat| nt) 0.0173654
     infiny-regularity:  min 0.000110997  max 2.63047
     anisomax  4865.47, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 52 ----------------------------------------
  -- Solve : 
          min -0.0248687  max 0.105649
Compliance :0.365327-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.23679  max 3.40117
Step too big: we step back !!!
Mesh adaptation done
Iteration 53 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.90827  max 1.45478
We increase the step size
Mesh moved
Actual Step 6.36419e-15------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1160 , h  min 0.00175392 , h max 0.140556
     area =  0.386468 , M area = 454.807 , M area/( |Khat| nt) 0.905458
     infiny-regularity:  min 0.00841329  max 2.24172
     anisomax  1000.91, beta max = 12.6958 min  0.790682
  --  mesh:  Nb of Triangles =   1160, Nb of Vertices 685
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.17369 , M area/( |Khat| nt) 0.01737
     infiny-regularity:  min 0.000110997  max 2.63075
     anisomax  4865.47, beta max = 159.465 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 54 ----------------------------------------
  -- Solve : 
          min -0.0245575  max 0.105038
Compliance :0.364596-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.51944  max 3.8477
Step too big: we step back !!!
Mesh adaptation done
Iteration 55 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.92145  max 1.47913
We increase the step size
Mesh moved
Actual Step 1.63221e-15------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1136 , h  min 0.0017598 , h max 0.140969
     area =  0.386472 , M area = 464.163 , M area/( |Khat| nt) 0.943608
     infiny-regularity:  min 0.00841271  max 2.19969
     anisomax  1001.27, beta max = 12.6865 min  0.720277
  --  mesh:  Nb of Triangles =   1136, Nb of Vertices 674
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386022 , M area = 2.17364 , M area/( |Khat| nt) 0.0173695
     infiny-regularity:  min 0.000110995  max 2.64778
     anisomax  4865.57, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 56 ----------------------------------------
  -- Solve : 
          min -0.0247899  max 0.104955
Compliance :0.362719-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.32364  max 3.49641
Step too big: we step back !!!
Mesh adaptation done
Iteration 57 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.89703  max 1.43401
We increase the step size
Mesh moved
Actual Step 4.1109e-16------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1120 , h  min 0.0017486 , h max 0.207443
     area =  0.386467 , M area = 445.654 , M area/( |Khat| nt) 0.918923
     infiny-regularity:  min 0.00841381  max 2.32998
     anisomax  1000.58, beta max = 30.5135 min  0.780144
  --  mesh:  Nb of Triangles =   1120, Nb of Vertices 664
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.15332 , M area/( |Khat| nt) 0.0172072
     infiny-regularity:  min 0.000110998  max 2.0342
     anisomax  4865.42, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 58 ----------------------------------------
  -- Solve : 
          min -0.0245086  max 0.104885
Compliance :0.362851-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.29102  max 3.46031
Step too big: we step back !!!
Mesh adaptation done
Iteration 59 ----------------------------------------
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance :0.366693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.90465  max 1.4481
We increase the step size
Mesh moved
Actual Step 1.04255e-16------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1135 , h  min 0.00175224 , h max 0.196942
     area =  0.386468 , M area = 450.911 , M area/( |Khat| nt) 0.917476
     infiny-regularity:  min 0.00841356  max 2.29895
     anisomax  1000.81, beta max = 12.6985 min  0.718992
  --  mesh:  Nb of Triangles =   1135, Nb of Vertices 672
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 289 , h  min 0.00487535 , h max 0.496159
     area =  0.386021 , M area = 2.17109 , M area/( |Khat| nt) 0.0173492
     infiny-regularity:  min 0.000110997  max 2.62561
     anisomax  4865.49, beta max = 159.464 min  1.99375
  --  mesh:  Nb of Triangles =    289, Nb of Vertices 188
Mesh adaptation done
Iteration 60 ----------------------------------------
  -- Solve : 
          min -0.0247752  max 0.10521
Compliance :0.364389-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.30996  max 3.4991
Step too big: we step back !!!
Mesh adaptation done
  number of required edges : 0
  number of required edges : 0
  number of required edges : 0
  number of required edges : 0
  -- Solve : 
          min -0.0244815  max 0.105483
Compliance : 0.366693-------------------------------------
times: compile 0.027718s, execution 14.7241s,  mpirank:0
 CodeAlloc : nb ptr  5538,  size :559600 mpirank: 0
Ok: Normal End
