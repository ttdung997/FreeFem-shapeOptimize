-- FreeFem++ v4.700001 (Sat Oct 17 12:48:33 CEST 2020 - git v4.7-64-g08041365)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue 
    1 : ////////////////////////////////////////////////
    2 : // Compliance Optimization                    //
    3 : // by the boundary variation method           //
    4 : // Copyright O.Pantz, G. Allaire (2005)       //
    5 : ////////////////////////////////////////////////
    6 : 
    7 : // Optimization Parameters 
    8 : int niter=60;			//Number of iterations
    9 : real errelas=0.01;		//Error for the resolution of the variational problems
   10 : real metricmsh=5.;		//Metric used for the coarse mesh: Bigger=finer mesh
   11 : real initialstep=0.2;		//Initial step
   12 : real maxstep=-1.;		//Maximum step (<0 => no limit)
   13 : real lagrangestep=3.;		//Updating step of the Lagrange multiplier associated to the Volume's constraint
   14 : bool tocontinue=false;		//false=start a new computation, true=continue a previous computation
   15 : string backupname="output";	//Name under which the results are stored
   16 : int nsave=1;			//Number of iterations to be saved
   17 : real volume0=95.;		//=0 Constant Volume during the iterations, >0 Target Volume, <0 No Volume's constraint
   18 : 
   19 : int np =10;
   20 : // construction of the initial mesh
   21 : 	mesh Sh,Th,Shprev,Thprev;
   22 : 	//Definition of the boundary labels
   23 : 	int neumann=1; int dirichlet=2;
   24 : 	int free=3;
   25 : 
   26 : 
   27 : 	int WALL = 1;
   28 : 	int LOAD = 2;
   29 : 	int FREE = 3;
   30 : //this is case 1
   31 : 	
   32 :  // border L11(t = 0.0, 0.5){x = t; y = 0.0; label = FREE;}
   33 :  //    border L21(t = 0.0, 0.45){x = 0.5; y = t; label = FREE;}
   34 :  //    border L22(t = 0.45, 0.55){x = 0.5; y = t; label = LOAD;}
   35 :  //    border L23(t = 0.55, 1.0){x = 0.5; y = t; label = FREE;}
   36 :  //    border L31(t = 0.5, 0){x = t; y = 1.0; label = FREE;}
   37 :  //    border L41(t = 1.0, 0.9){x = 0.0; y = t; label = WALL;}
   38 :  //    border L42(t = 0.9, 0.1){x = 0.0; y = t; label = FREE;}
   39 :  //    border L43(t = 0.1, 0.0){x = 0.0; y = t; label = WALL;}
   40 : 
   41 :  //    Sh = buildmesh(L11(5 * np) + L21(5 * np) + L22(1 * np) + L23(5 * np) + L31(5 * np) + L41(1 * np) + L42(8 * np) + L43(1 * np));
   42 : 
   43 : 
   44 : //this is case 2
   45 : 
   46 : 	// real r = 0.15;                                                                    
   47 : 
   48 :  //    border L11(t = -1.0, 1.0){x = t; y = 0.0; label = FREE;}
   49 :  //    border L21(t = 0.0, 0.45){x = 1.0; y = t; label = FREE;}
   50 :  //    border L22(t = 0.45, 0.55){x = 1.0; y = t; label = LOAD;}
   51 :  //    border L23(t = 0.55, 1.0){x = 1.0; y = t; label = FREE;}
   52 :  //    border L31(t = 1.0, -1.0){x = t; y = 1.0; label = FREE;}
   53 :  //    border L41(t = 1.0, 0.9){x = -1.0; y = t; label = WALL;}
   54 :  //    border L42(t = 0.9, 0.1){x = -1.0; y = t; label = FREE;}
   55 :  //    border L43(t = 0.1, 0.0){x = -1.0; y = t; label = WALL;}
   56 : 
   57 :     
   58 :  //    border C11(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.22 + r * sin(t); label = FREE;}
   59 :  //    border C12(t = 0, 2 * pi){x = 0.2 + r * cos(t); y = 0.22 + r * sin(t); label = FREE;}
   60 :  //    border C21(t = 0, 2 * pi){x = -0.2 + r * cos(t); y = 0.5 + r * sin(t); label = FREE;}
   61 :  //    border C22(t = 0, 2 * pi){x = 0.6 + r * cos(t); y = 0.5 + r * sin(t); label = FREE;}
   62 :  //    border C31(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.78 + r * sin(t); label = FREE;}
   63 :  //    border C32(t = 0, 2 * pi){x = 0.2 + r * cos(t); y = 0.78 + r * sin(t); label = FREE;}
   64 : 
   65 :  //    Sh = buildmesh(L11(20 * np) + L21(5 * np) + L22(1 * np) + L23(5 * np) + L31(20 * np) + L41(1 * np) + L42(8 * np) + L43(1 * np)
   66 :  //                    + C11(-10 * np) + C12(-10 * np)  + C21(-10 * np) + C22(-10 * np) + C31(-10 * np) + C32(-10 * np));
   67 : 
   68 : 
   69 : //this is case 3
   70 : 
   71 : 	 real r = 0.2;                                                 
   72 : 
   73 :     border L11(t = 0.0, 1.0){x = t; y = 0.0; label = FREE;}
   74 :     border L21(t = 0.0, 0.2){x = 1.0; y = t; label = LOAD;}
   75 :     border L22(t = 0.2, 0.8){x = 1.0; y = t; label = FREE;}
   76 :     border L23(t = 0.8, 1.0){x = 1.0; y = t; label = LOAD;}
   77 :     border L31(t = 1.0, 0.0){x = t; y = 1.0; label = FREE;}
   78 :     border L41(t = 1.0, 0.95){x = 0.0; y = t; label = WALL;}
   79 :     border L42(t = 0.95, 0.05){x = 0.0; y = t; label = FREE;}
   80 :     border L43(t = 0.05, 0.0){x = 0.0; y = t; label = WALL;}
   81 : 
   82 :     
   83 :     border C11(t = 0, 2 * pi){x = 0.5 + r * cos(t); y = 0.25 + r * sin(t); label = FREE;}
   84 :     border C31(t = 0, 2 * pi){x = 0.5 + r * cos(t); y = 0.75 + r * sin(t); label = FREE;}
   85 : 
   86 :     Sh = buildmesh(L11(10 * np) + L21(2 * np) + L22(6 * np) + L23(2 * np) + L31(10 * np) + L41(1 * np) + L42(9 * np) + L43(1 * np)
   87 :         + C11(-15 * np) + C31(-15 * np)
   88 :         );
   89 : 
   90 : 
   91 : //this is case 4:
   92 : 
   93 : 	 // real r = 0.25;
   94 : 
   95 :   //   border L11(t = -1.0, -0.9){x = t; y = 0; label = FREE;}
   96 :   //   border L12(t = -0.9, -0.2){x = t; y = 0; label = FREE;}
   97 :   //   border L13(t = -0.2, 0.2){x = t; y = 0; label = FREE;}
   98 :   //   border L14(t = 0.2, 0.9){x = t; y = 0; label = FREE;}
   99 :   //   border L15(t = 0.9, 1.0){x = t; y = 0; label = FREE;}
  100 :     
  101 :   //   border L21(t = 0, 1.2){x = 1.0; y = t; label = FREE;}
  102 :   //   border L22(t = 1.0, -1.0){x = t; y = 1.2; label = FREE;}
  103 :   //   border L23(t = 1.2, 0){x = -1.0; y = t; label = FREE;}
  104 :     
  105 :   //   border C10(t = 0, 2 * pi){x = -0.6 + r * cos(t); y = 0.4 + r * sin(t); label = FREE;}
  106 :   //   border C11(t = 0, 2 * pi){x = r * cos(t); y = 0.8 + r * sin(t); label = FREE;}
  107 :   //   border C12(t = 0, 2 * pi){x = 0.6 + r * cos(t); y = 0.4 + r * sin(t); label = FREE;}
  108 : 
  109 :   //   Sh = buildmesh(L11(1 * np) + L12(7 * np) + L13(4 * np) + L14(7 * np) + L15(1 * np) + L21(12 * np) + L22(20 * np) + L23(12 * np) 
  110 :   //       + C10(-15 * np) + C11(-15 * np) + C12(-15 * np) 
  111 :   //       );
  112 : 
  113 : 
  114 : //this is case 5
  115 : // real r = 0.05;
  116 : 
  117 : //     border L11(t = 0.4, -0.4){x = t; y = 1.2; label = FREE;}
  118 : //     border L21(t = 1.2, 0.8){x = -0.4; y = t; label = FREE;}
  119 : //     border L31(t = -0.4, -0.35){x = t; y = 0.8; label = LOAD;}
  120 : //     border L32(t = -0.35, -0.2){x = t; y = 0.8; label = FREE;}
  121 : //     border L41(t = 0.8, 0.0){x = -0.2; y = t; label = FREE;}
  122 : //     border L51(t = -0.2, -0.15){x = t; y = 0.0; label = WALL;}
  123 : //     border L52(t = -0.15, 0.15){x = t; y = 0.0; label = FREE;}
  124 : //     border L53(t = 0.15, 0.2){x = t; y = 0.0; label = WALL;}
  125 : //     border L42(t = 0.0, 0.8){x = 0.2; y = t; label = FREE;}
  126 : //     border L33(t = 0.2, 0.35){x = t; y = 0.8; label = FREE;}
  127 : //     border L34(t = 0.35, 0.4){x = t; y = 0.8; label = LOAD;}
  128 : //     border L22(t = 0.8, 1.2){x = 0.4; y = t; label = FREE;}
  129 : 
  130 : //     border C1(t = 0, 2 * pi){x = -0.25 + r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  131 : //     border C2(t = 0, 2 * pi){x = r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  132 : //     border C3(t = 0, 2 * pi){x = 0.25 + r * cos(t); y = 1.0 + r * sin(t); label = FREE;}
  133 : 
  134 : //     Sh = buildmesh(L11(8 * np) + L21(4 * np) + L31(1 * np) + L32(2 * np) + L41(8 * np) + L51(np) + L52(3 * np) + L53(1 * np) 
  135 : //                     + L42(8 * np) + L33(2 * np) + L34(1 * np) + L22(4 * np) + C1(-7 * np) + C2(-7 * np) + C3(-7 * np));
  136 : 
  137 : 
  138 : 
  139 : // 	Th=Sh;
  140 : // 	Thprev=Th;
  141 : 
  142 : 	// cut function used to regularize the gradient shape near singularities
  143 : 	// func cut=1-(x>19.5)*(abs(y)<1.5)-(x<0.5)*(y>1.5)*(y<4.5)-(x<0.5)*(y<-1.5)*(y>-4.5);
  144 : 
  145 : 
  146 : 	func cut=(x > 0.5) ;
  147 : 
  148 : // Material parameters
  149 : 	real E=15.;				//Young Modulus (always positif)
  150 : 	real nu=0.35;				//Poisson ratio (between -1 and 1/2)
  151 : 	real lambda=E*nu/((1.+nu)*(1.-2.*nu));	//Lame Moduli
  152 : 	real mu=E/(2.*(1.+nu));
  153 : 
  154 : //Applied Loads
  155 : 	func g1=50; func g2=50;
  156 : 
  157 : //Definition of the variables and intialization
  158 : 	//Finite elements spaces on the finer mesh Sh
  159 : 		fespace Wh(Sh,P1);  		
  160 : 		fespace WSh(Sh,[P2,P2]);
  161 : 	//Finite elements spaces on the coarse mesh Th
  162 : 		fespace WTh(Th,[P2,P2]);	
  163 : 		
  164 : 	Wh gradient; 			//Gradient
  165 : 	WSh [d1,d2];			//extension field
  166 : 	WSh [theta1,theta2];		//test functions for the extension field
  167 : 	WSh [u1,u2],[v1,v2];		//Displacement and Test functions
  168 : 
  169 : 	//Interpolated Finite elements on the coarse mesh
  170 : 	WTh [D1,D2],[Dprev1,Dprev2]; 
  171 : 	WTh [U1,U2],[Uprev1,Uprev2];
  172 : 
  173 : 	int nsaved=0;			//Initialization counter of the back-up copies
  174 : 	int nsave0=100;			//Current number of back-up copies
  175 : 	real compliance;		//Compliance
  176 : 	real volume;
 *** Warning  The identifier volume hide a Global identifier  
			//Volume of the current shape
  177 : 	real perimeter;			//Perimeter of the optimized boundary
  178 : 	string caption;			//Caption for graphic outputs
  179 : 	real GradNorm;			//Gradient Norm
  180 : 	real GradProduct;		//Scalar product between the current gradient and the previous one
  181 : 	bool rollback=false;		//Did we roll back ?
  182 : 	real actualstep;		//Actual step size
  183 : 	real lagrange;			//Lagrange Multiplier associated to the Volume constraint
  184 : 	real[int] isoval(20);		//isovalue used for graphic outputs
  185 : 
  186 : 	int constrained=1;
  187 : 	if (volume0<0) {constrained=0;};
  188 : 
  189 : /////////////////////////
  190 : // Elasticity Problem  //
  191 : /////////////////////////
  192 : 	problem elasticity([u1,u2],[v1,v2]) =
  193 : 		int2d(Sh)(
  194 :         		2.*mu*(dx(u1)*dx(v1)+dy(u2)*dy(v2)+((dx(u2)+dy(u1))*(dx(v2)+dy(v1)))/2.)
  195 :               		+lambda*(dx(u1)+dy(u2))*(dx(v1)+dy(v2)))
  196 : 		-int1d(Sh,neumann)(g1*v1+g2*v2)	           
  197 :     	+on(FREE,u1=0,u2=0);
  198 : 
  199 : ////////////////////////////////////////
  200 : // Expression of the shape's Gradient //
  201 : ////////////////////////////////////////
  202 : 	macro gradientexp()
  203 # 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 # //
  205 : 
  206 : ///////////////////////
  207 : // Extension Problem //
  208 : ///////////////////////
  209 : //  H1 scalar product between vector-valued functions
  210 : 	macro prodscal(t1,t2,p1,p2)
  211 # 		dx(t1)*dx(p1)+dy(t1)*dy(p1)+dx(t2)*dx(p2)+dy(t2)*dy(p2)+t1*p1+t2*p2
  212 #  )  //
  213 : 	problem extension([d1,d2],[theta1,theta2]) =
  214 : 		int2d(Sh)(prodscal(d1,d2,theta1,theta2)
  211 @ 		
  212 @ 
  211 @ 		dx(d1)*dx(theta1)+dy(d1)*dy(theta1)+dx(d2)*dx(theta2)+dy(d2)*dy(theta2)+d1*theta1+d2*theta2
  212 @ )
  215 : 		+int1d(Sh,free) ((theta1*N.x+theta2*N.y)*(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @  + lagrange*constrained)*cut)
  216 : 	  +on(WALL,d1=0,d2=0);
  217 : 
  218 : //////////////////////////////
  219 : //      Initialization      //
  220 : //////////////////////////////
  221 : int iter,iter0;
  222 : string  backupnameNb;
  223 : if(!tocontinue){
  224 : 	iter0=1;
  225 : 	if (volume0==0) {volume0=int1d(Sh)(x*N.x+y*N.y)/2;}	// Computation of the initial Volume
  226 : 	elasticity;						// Solving the State Equation
  227 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);		// Initial Compliance
  228 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );				// Computation of the shape derivative
  229 : 
  230 : 	//Evaluation of the Lagrande Multiplier associated to the Volume constraint
  231 : 	lagrange=int1d(Sh,free)(gradient*cut)/int1d(Sh,free)(cut);
  232 : 	gradient=(gradient-lagrange*constrained)*cut;
  233 : 
  234 : 	//Mesh Adaptation
  235 : 		Th=Sh;
  236 : 		[U1,U2]=[u1,u2];   //interpolation of u on the coarse mesh Th
  237 : 		[Uprev1,Uprev2]=[0,0]; Uprev1[]=U1[]; Uprev2[]=U2[];
  238 : 		Sh=adaptmesh (Th,Uprev1,Uprev2,err=errelas);
  239 : 		actualstep=initialstep;			//Initialization of the initial step
  240 : 
  241 : 	//We save the intial shape
  242 : 	if (nsave!=0) {
  243 : 		//isovalue for graphic output
  244 : 			real gmax=gradient[].max;
  245 : 			real gmin=gradient[].min;
  246 : 			for (int j=0;j<isoval.n;j++) isoval[j]=gmin+(gmax-gmin)/isoval.n*j;
  247 : 		caption="Initial shape, Compliance "+compliance+", Volume "+volume0;
  248 : 		backupnameNb=backupname+nsaved;
  249 : 		plot(gradient,fill=1,value=1,cmm=caption,viso=isoval,ps= "output/"+backupnameNb+".eps");};}
  250 : else {
  251 : // We recover the datas of a previous computation
  252 : 	// Updating of the meshs if we continue a previous computation
  253 : 		Sh=readmesh(backupname+".msh");
  254 : 		Th=readmesh(backupname+"-geo.msh");
  255 : 		Shprev=readmesh(backupname+"-prev.msh");
  256 : 		Thprev=readmesh(backupname+"-geo-prev.msh");
  257 : 	ifstream f(backupname+".txt");
  258 : 	if (volume0==0) {f >>volume0;} else {real next; f >>next;};
  259 : 	f >>lagrange;		//Lagrange Multiplier
  260 : 	f >>actualstep;		//Actual step size
  261 : 	f >>rollback;		//Did we roll back ?
  262 : 	f >>iter0;		//iteration de dÃ©part
  263 : 	f >>nsave0;		//Number of previous back-up copies
  264 : 	f >>isoval;
  265 : 	f >>Dprev1[];f>>Dprev2[];//Previous extenstion fields
  266 : 	nsaved=nsave0; 
  267 : 	nsave0=nsave0+1;};
  268 : 
  269 : /////////////////////////////////////
  270 : // Initialization of the Algorithm //
  271 : /////////////////////////////////////
  272 : 	elasticity;					//Solving the state equation
  273 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);	//Initial compliance
  274 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );			//Computation of the shape derivative
  275 : 	//Evaluation of the Lagrange Multiplier associated to the Volume constraint
  276 : 	lagrange=int1d(Sh,free)(gradient*cut)/int1d(Sh,free)(cut);
  277 : 	gradient=(gradient-lagrange*constrained)*cut;
  278 : 
  279 : ///////////////////////////////
  280 : //     Optimization Loop     //
  281 : ///////////////////////////////
  282 : for (iter=iter0;iter< niter+iter0;iter=iter+1){
  283 : 	cout <<"Iteration " <<iter <<" ----------------------------------------" <<endl;
  284 : 
  285 : 	////////////////////////////
  286 : 	// Gradient's Computation //
  287 : 	////////////////////////////
  288 : 	elasticity;
  289 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);
  290 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ )*cut;
  291 : 	cout<<"Compliance :"<<compliance<<"-------------------------------------"<<endl;
  292 : 
  293 : 	[U1,U2]=[u1,u2];  //interpolation of u on the coarse mesh
  294 : 
  295 : 	//Update of the lagrange multiplier
  296 : 		volume=int1d(Sh)(x*N.x+y*N.y)/2;
  297 : 		perimeter=int1d(Sh,free)(cut);
  298 : 		lagrange=0.5*lagrange+0.5*int1d(Sh,free)(gradient)/perimeter
  299 : 		+lagrangestep*(volume-volume0)/volume0;
  300 : 	gradient=gradient-lagrange*constrained*cut;
  301 : 	
  302 : 	/////////////////////
  303 : 	// Graphic Outputs //
  304 : 	/////////////////////
  305 : 	//isovalues
  306 : 		real gmax=gradient[].max;
  307 : 		for (int j=0;j<isoval.n;j++) 
  308 : 		isoval[j]=isoval[j]*(0.7*isoval[isoval.n-1]+0.3*gmax)/isoval[isoval.n-1];
  309 : 	caption="Iteration "+iter+", Compliance="+compliance+", Volume="+volume;
  310 : 	backupnameNb="output/"+backupname+nsaved+".eps";
  311 : 	plot(gradient,fill=1,value=1,cmm=caption,viso=isoval);
  312 : 	
  313 : 	/////////////////////////
  314 : 	// Back-up Iterations  //
  315 : 	/////////////////////////
  316 : 	if ((nsaved-nsave0)*niter<(iter-iter0-1)*nsave) {
  317 : 	nsaved=nsaved+1;
  318 : 	caption="Iteration "+iter+", Compliance ="+compliance+", Volume="+volume;
  319 : 	backupnameNb="output/"+backupname+nsaved+".eps";
  320 : 	plot(gradient,fill=1,value=1,cmm=caption,viso=isoval,ps=backupnameNb);
  321 : 	savemesh(Sh,backupname+".msh");};
  322 : 
  323 : 	///////////////////////////////
  324 : 	// Modification of the shape //
  325 : 	///////////////////////////////
  326 : 	extension;		//Computation of the field [d1,d2]
  327 : 	[D1,D2]=[d1,d2];	//Interpolation on the coarse mesh
  328 : 
  329 : 	////////////////////////////////////
  330 : 	// Updating the step              //
  331 : 	////////////////////////////////////
  332 : 	GradNorm=int2d(Th)(prodscal(D1,D2,D1,D2)
  211 @ 		
  212 @ 
  211 @ 		dx(D1)*dx(D1)+dy(D1)*dy(D1)+dx(D2)*dx(D2)+dy(D2)*dy(D2)+D1*D1+D2*D2
  212 @ );
  333 : 	GradProduct=int2d(Th)(prodscal(D1,D2,Dprev1,Dprev2)
  211 @ 		
  212 @ 
  211 @ 		dx(D1)*dx(Dprev1)+dy(D1)*dy(Dprev1)+dx(D2)*dx(Dprev2)+dy(D2)*dy(Dprev2)+D1*Dprev1+D2*Dprev2
  212 @ );
  334 : 	if ((GradProduct<0.)&(!rollback)) {
  335 : 		actualstep=actualstep*GradNorm/(GradNorm-GradProduct)/4.; 
  336 :                 cout<<"Step too big: we step back !!!"<<endl; Th=Thprev; Sh=Shprev; rollback=true;}
  337 : 	else 
  338 : 		rollback=false;
  339 : 	if ((GradProduct>0.)&(GradProduct<(GradNorm/2.))){
  340 : 		actualstep=actualstep*2.*GradNorm/(2.*GradNorm-GradProduct); 
  341 :                 cout<<"We increase the step size"<<endl;};
  342 : 	if (GradProduct>(GradNorm/2.)){
  343 : 		actualstep=actualstep*4./3.;
  344 : 		cout<<"We increase the step size"<<endl;};
  345 : 	if(maxstep>0.) 
  346 : 		actualstep=min(actualstep,maxstep);
  347 : 	Thprev=Th;	//We keep a copy of the meshs (in case of backup at the next loop's step)
  348 : 	Shprev=Sh;
  349 : 
  350 : 	//////////////////////////////////
  351 : 	// We move the coarse mesh Th   //
  352 : 	//////////////////////////////////
  353 : 	if (!rollback){
  354 : 		real aa,minaire=checkmovemesh (Th,[x,y])/10000.;
  355 : 		while (minaire > (aa=checkmovemesh(Th,[x+actualstep*D1,y+actualstep*D2])) ){
  356 :   			cout << " problem reversed triangle  => actualstep= actual
  ... : step/2. "<<endl; 
  357 : 			actualstep= actualstep/2.;
  358 : 					}
  359 : 		Th = movemesh (Th,[x+actualstep*D1,y+actualstep*D2]);
  360 : 		cout<<"Mesh moved"<<endl;
  361 : 		cout<<"Actual Step "<<actualstep<<"------------------------------------"<<endl;
  362 : 		[Dprev1,Dprev2]=[0,0];
  363 : 		Dprev1[]=D1[];Dprev2[]=D2[];
  364 : 		[Uprev1,Uprev2]=[0,0]; Uprev1[]=U1[]; Uprev2[]=U2[]; //Interpolation of u on the new mesh Th
  365 : 		};
  366 : 
  367 : 	//////////////////////
  368 : 	// Mesh Adaptation  //
  369 : 	//////////////////////
  370 : 	if (rollback){Sh=Shprev; } 		//We step back
  371 : 	else {
  372 : 		cout<<"Mesh adaptation of Sh"<<endl;
  373 : 		Sh=adaptmesh(Th,Uprev1,Uprev2,[Dprev1,Dprev2],err=errelas);
  374 : 		plot(Sh,wait=0);
  375 : 		cout<<"Mesh adaptation of the coarse mesh Th"<<endl;
  376 : 		Th=adaptmesh(Sh,metricmsh,0,metricmsh,IsMetric=1,ratio=0,omega=200,splitpbedge=1,hmin=0.05,abserror=1); }
  377 : 	cout<<"Mesh adaptation done"<<endl;
  378 : };
  379 : ///// END OF THE OPTIMIZATION LOOP /////
  380 : 
  381 : // Back-up    ///////////////////////////////////////////////
  382 : if (nsave!=0) {
  383 : 	//We save the meshes
  384 : 		savemesh(Sh,backupname+".msh");
  385 : 		savemesh(Shprev,backupname+"-prev.msh");
  386 : 		savemesh(Th,backupname+"-geo.msh");
  387 : 		savemesh(Th,backupname+"-geo-prev.msh");
  388 : 	//We save all variables
  389 : 		{ofstream f(backupname+".txt");
  390 : 		f << volume0<<"\n";	//Initial Volume
  391 : 		f <<lagrange<<"\n";	//Lagrange Multiplier
  392 : 		f <<actualstep<<"\n";	//Actual step
  393 : 		f <<rollback<<"\n";	//boolean variable
  394 : 		f <<iter<<"\n";		//Current Iteration
  395 : 		f <<nsaved+1<<"\n";	//Number of back-up done
  396 : 		f <<isoval<<"\n";
  397 : 		[Dprev1,Dprev2]=[Dprev1,Dprev2];
  398 : 		f <<Dprev1[]<<endl;f<<Dprev2[]<<endl;};
  399 : 	nsaved=nsaved+1;
  400 : 	elasticity;
  401 : 	gradient=-(gradientexp
  203 @ 	
  204 @ 
  203 @ 	-2.*mu*(dx(u1)^2+dy(u2)^2+((dx(u2)+dy(u1))^2)/2.)-lambda*(dx(u1)+dy(u2))^2
  204 @ );
  402 : 	compliance=int1d(Sh,neumann)(g1*u1+g2*u2);
  403 : 	cout<<"Compliance : "<<compliance<<"-------------------------------------"<<endl;
  404 : 	gradient=gradient*cut;
  405 : 	volume=int2d(Sh)(1.);
  406 : 	perimeter=int1d(Sh,free)(cut);
  407 : 	lagrange=0.5*lagrange+0.5*int1d(Sh,free)(gradient)/perimeter+lagrangestep*(volume-volume0)/volume0;
  408 : 	gradient=gradient-lagrange*constrained*cut;
  409 : 	//Graphic output of the gradient
  410 : 		caption="Iteration "+iter+", Compliance ="+compliance+", Volume="+volume;
  411 : 		backupnameNb=backupname+nsaved+".eps";
  412 : 		plot(gradient,fill=1,value=0,cmm=caption,viso=isoval,ps="output/"+ backupnameNb);
  413 : };
  414 :  sizestack + 1024 =11240  ( 10216 )

  --  mesh:  Nb of Triangles =  19560, Nb of Vertices 10134
  -- Solve : 
          min -0.0126633  max 0.128044
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2814 , h  min 0.000862216 , h max 0.2
     area =  0.751573 , M area = 1212.27 , M area/( |Khat| nt) 0.994885
     infiny-regularity:  min 0.0850289  max 2.18238
     anisomax  6.26006, beta max = 3.62483 min  0.754668
  --  mesh:  Nb of Triangles =   2814, Nb of Vertices 1525
  -- Solve : 
          min -0.0127319  max 0.129616
Iteration 1 ----------------------------------------
  -- Solve : 
          min -0.0127319  max 0.129616
Compliance :0.848768-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -1.25901  max 1.20805
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.1------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 3487 , h  min 0.000667089 , h max 0.121549
     area =  0.900922 , M area = 1549.64 , M area/( |Khat| nt) 1.02631
     infiny-regularity:  min 0.413173  max 2.02183
     anisomax  4.2417, beta max = 1.31398 min  0.744014
  --  mesh:  Nb of Triangles =   3487, Nb of Vertices 1909
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 269 , h  min 0.00430135 , h max 0.440593
     area =  0.897962 , M area = 22.8439 , M area/( |Khat| nt) 0.196118
     infiny-regularity:  min 0.00641174  max 7.44814
     anisomax  50.4414, beta max = 25.8985 min  0.576306
  --  mesh:  Nb of Triangles =    269, Nb of Vertices 177
Mesh adaptation done
Iteration 2 ----------------------------------------
  -- Solve : 
          min -0.0117699  max 0.13379
Compliance :0.88693-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.0882  max 2.09082
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0666667------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2307 , h  min 0.00474914 , h max 0.144569
     area =  1.10564 , M area = 1032.76 , M area/( |Khat| nt) 1.03383
     infiny-regularity:  min 0.197667  max 2.56536
     anisomax  5.2384, beta max = 2.02596 min  0.733007
  --  mesh:  Nb of Triangles =   2307, Nb of Vertices 1257
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 231 , h  min 0.00266368 , h max 0.53034
     area =  1.10718 , M area = 11.4638 , M area/( |Khat| nt) 0.114608
     infiny-regularity:  min 0.00263116  max 7.61799
     anisomax  15.2116, beta max = 120.542 min  0.921767
  --  mesh:  Nb of Triangles =    231, Nb of Vertices 152
Mesh adaptation done
Iteration 3 ----------------------------------------
  -- Solve : 
          min -0.0108813  max 0.131332
Compliance :0.830877-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.61403  max 2.69593
We increase the step size
Mesh moved
Actual Step 0.0888889------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2264 , h  min 0.00529887 , h max 0.167146
     area =  1.57721 , M area = 1006.43 , M area/( |Khat| nt) 1.02661
     infiny-regularity:  min 0.177915  max 2.35667
     anisomax  4.45214, beta max = 2.16469 min  0.739104
  --  mesh:  Nb of Triangles =   2264, Nb of Vertices 1239
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 187 , h  min 0.0047385 , h max 0.467455
     area =  1.57871 , M area = 10.6367 , M area/( |Khat| nt) 0.13136
     infiny-regularity:  min 0.00163217  max 6.26286
     anisomax  16.1341, beta max = 152.533 min  1.02672
  --  mesh:  Nb of Triangles =    187, Nb of Vertices 124
Mesh adaptation done
Iteration 4 ----------------------------------------
  -- Solve : 
          min -0.00845234  max 0.131714
Compliance :0.831496-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.18841  max 3.24948
We increase the step size
Mesh moved
Actual Step 0.118519------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2132 , h  min 0.00520219 , h max 0.209763
     area =  2.63367 , M area = 962.571 , M area/( |Khat| nt) 1.04267
     infiny-regularity:  min 0.17781  max 3.48548
     anisomax  5.75504, beta max = 2.13361 min  0.668672
  --  mesh:  Nb of Triangles =   2132, Nb of Vertices 1167
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 170 , h  min 0.00538078 , h max 0.733976
     area =  2.62698 , M area = 14.2828 , M area/( |Khat| nt) 0.194028
     infiny-regularity:  min 0.00297313  max 5.35344
     anisomax  25.8642, beta max = 106.189 min  0.863656
  --  mesh:  Nb of Triangles =    170, Nb of Vertices 114
Mesh adaptation done
Iteration 5 ----------------------------------------
  -- Solve : 
          min -0.00596405  max 0.134629
Compliance :0.854992-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.57842  max 5.32633
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0790123------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1953 , h  min 0.00217917 , h max 0.288118
     area =  3.64296 , M area = 863.288 , M area/( |Khat| nt) 1.02083
     infiny-regularity:  min 0.065506  max 14.3931
     anisomax  13.7154, beta max = 2.66248 min  0.581117
  --  mesh:  Nb of Triangles =   1953, Nb of Vertices 1070
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 175 , h  min 0.00470241 , h max 0.62839
     area =  3.65081 , M area = 21.072 , M area/( |Khat| nt) 0.278078
     infiny-regularity:  min 0.00435519  max 14.5475
     anisomax  135.807, beta max = 24.9472 min  0.807918
  --  mesh:  Nb of Triangles =    175, Nb of Vertices 116
Mesh adaptation done
Iteration 6 ----------------------------------------
  -- Solve : 
          min -0.00617521  max 0.134878
Compliance :0.854439-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.6401  max 3.89695
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00624138------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2094 , h  min 0.0011626 , h max 0.281154
     area =  3.76595 , M area = 939.67 , M area/( |Khat| nt) 1.03633
     infiny-regularity:  min 0.0660212  max 9.77186
     anisomax  24.8077, beta max = 1.90687 min  0.714473
  --  mesh:  Nb of Triangles =   2094, Nb of Vertices 1144
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 169 , h  min 0.00484778 , h max 0.735155
     area =  3.77078 , M area = 19.7232 , M area/( |Khat| nt) 0.26952
     infiny-regularity:  min 0.00464789  max 5.74271
     anisomax  215.802, beta max = 74.8791 min  0.691278
  --  mesh:  Nb of Triangles =    169, Nb of Vertices 113
Mesh adaptation done
Iteration 7 ----------------------------------------
  -- Solve : 
          min -0.00601669  max 0.130485
Compliance :0.854435-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.6175  max 3.89731
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00416092------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2024 , h  min 0.00121683 , h max 0.29933
     area =  3.84976 , M area = 921.376 , M area/( |Khat| nt) 1.0513
     infiny-regularity:  min 0.0735511  max 18.6925
     anisomax  22.2896, beta max = 2.03884 min  0.361367
  --  mesh:  Nb of Triangles =   2024, Nb of Vertices 1110
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 173 , h  min 0.00495472 , h max 0.649713
     area =  3.85226 , M area = 20.3701 , M area/( |Khat| nt) 0.271923
     infiny-regularity:  min 0.00456581  max 8.16322
     anisomax  219.686, beta max = 72.8886 min  0.804487
  --  mesh:  Nb of Triangles =    173, Nb of Vertices 115
Mesh adaptation done
Iteration 8 ----------------------------------------
  -- Solve : 
          min -0.00579694  max 0.126115
Compliance :0.812431-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.20663  max 3.93496
We increase the step size
Mesh moved
Actual Step 0.00554789------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2213 , h  min 0.00574673 , h max 0.242043
     area =  3.96279 , M area = 1004.26 , M area/( |Khat| nt) 1.04801
     infiny-regularity:  min 0.0439209  max 6.16014
     anisomax  21.0608, beta max = 1.28193 min  0.373915
  --  mesh:  Nb of Triangles =   2213, Nb of Vertices 1211
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 173 , h  min 0.00510027 , h max 0.656551
     area =  3.9629 , M area = 20.9889 , M area/( |Khat| nt) 0.280184
     infiny-regularity:  min 0.00438434  max 6.03983
     anisomax  228.792, beta max = 70.4925 min  0.768931
  --  mesh:  Nb of Triangles =    173, Nb of Vertices 115
Mesh adaptation done
Iteration 9 ----------------------------------------
  -- Solve : 
          min -0.00577619  max 0.132651
Compliance :0.836561-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.84947  max 3.88593
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0036986------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2060 , h  min 0.00110395 , h max 0.336234
     area =  4.03912 , M area = 911.878 , M area/( |Khat| nt) 1.02228
     infiny-regularity:  min 0.0844895  max 5.23722
     anisomax  23.4423, beta max = 2.93098 min  0.647034
  --  mesh:  Nb of Triangles =   2060, Nb of Vertices 1127
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 180 , h  min 0.00518623 , h max 0.643043
     area =  4.03736 , M area = 21.3894 , M area/( |Khat| nt) 0.274426
     infiny-regularity:  min 0.00426577  max 7.55773
     anisomax  235.163, beta max = 70.0333 min  0.762158
  --  mesh:  Nb of Triangles =    180, Nb of Vertices 119
Mesh adaptation done
Iteration 10 ----------------------------------------
  -- Solve : 
          min -0.00566093  max 0.129993
Compliance :0.835959-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.70315  max 3.903
We increase the step size
Mesh moved
Actual Step 0.00493146------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2348 , h  min 0.00116316 , h max 0.231686
     area =  4.14135 , M area = 1042.95 , M area/( |Khat| nt) 1.02581
     infiny-regularity:  min 0.0711312  max 4.38619
     anisomax  36.8341, beta max = 2.84943 min  0.61323
  --  mesh:  Nb of Triangles =   2348, Nb of Vertices 1283
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 181 , h  min 0.0053289 , h max 0.630314
     area =  4.13681 , M area = 21.5635 , M area/( |Khat| nt) 0.275131
     infiny-regularity:  min 0.00411275  max 10.9887
     anisomax  243.948, beta max = 68.0303 min  0.83998
  --  mesh:  Nb of Triangles =    181, Nb of Vertices 119
Mesh adaptation done
Iteration 11 ----------------------------------------
  -- Solve : 
          min -0.00548151  max 0.134132
Compliance :0.824883-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.68134  max 3.86423
We increase the step size
Mesh moved
Actual Step 0.00657528------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2198 , h  min 0.0012685 , h max 0.239996
     area =  4.27729 , M area = 985.809 , M area/( |Khat| nt) 1.03577
     infiny-regularity:  min 0.102846  max 6.02065
     anisomax  16.464, beta max = 2.17259 min  0.577233
  --  mesh:  Nb of Triangles =   2198, Nb of Vertices 1204
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 169 , h  min 0.00543933 , h max 0.657055
     area =  4.26965 , M area = 22.5104 , M area/( |Khat| nt) 0.307607
     infiny-regularity:  min 0.00392494  max 7.05849
     anisomax  255.685, beta max = 65.7719 min  0.798076
  --  mesh:  Nb of Triangles =    169, Nb of Vertices 112
Mesh adaptation done
Iteration 12 ----------------------------------------
  -- Solve : 
          min -0.00508726  max 0.126184
Compliance :0.830019-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.57446  max 4.01627
We increase the step size
Mesh moved
Actual Step 0.00876704------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2277 , h  min 0.00145265 , h max 0.231412
     area =  4.45641 , M area = 1025.12 , M area/( |Khat| nt) 1.03971
     infiny-regularity:  min 0.0325593  max 7.87094
     anisomax  22.3051, beta max = 3.24093 min  0.62552
  --  mesh:  Nb of Triangles =   2277, Nb of Vertices 1245
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 172 , h  min 0.00530205 , h max 0.653009
     area =  4.44553 , M area = 22.2276 , M area/( |Khat| nt) 0.298445
     infiny-regularity:  min 0.00371953  max 1.48138
     anisomax  269.903, beta max = 63.453 min  0.821074
  --  mesh:  Nb of Triangles =    172, Nb of Vertices 113
Mesh adaptation done
Iteration 13 ----------------------------------------
  -- Solve : 
          min -0.00476062  max 0.126312
Compliance :0.833514-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.49731  max 4.32512
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0058447------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2130 , h  min 0.00146658 , h max 0.237227
     area =  4.57567 , M area = 958.526 , M area/( |Khat| nt) 1.03926
     infiny-regularity:  min 0.0255729  max 7.66583
     anisomax  50.5825, beta max = 2.67638 min  0.484548
  --  mesh:  Nb of Triangles =   2130, Nb of Vertices 1166
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 174 , h  min 0.00522578 , h max 0.668564
     area =  4.56296 , M area = 22.8148 , M area/( |Khat| nt) 0.302808
     infiny-regularity:  min 0.00360607  max 1.52737
     anisomax  278.467, beta max = 77.9247 min  0.844847
  --  mesh:  Nb of Triangles =    174, Nb of Vertices 114
Mesh adaptation done
Iteration 14 ----------------------------------------
  -- Solve : 
          min -0.00580885  max 0.134591
Compliance :0.802375-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.4654  max 4.58389
We increase the step size
Mesh moved
Actual Step 0.00779293------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2129 , h  min 0.00114921 , h max 0.266987
     area =  4.73443 , M area = 942.081 , M area/( |Khat| nt) 1.02191
     infiny-regularity:  min 0.0611043  max 9.88384
     anisomax  44.0704, beta max = 1.71541 min  0.491752
  --  mesh:  Nb of Triangles =   2129, Nb of Vertices 1168
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 177 , h  min 0.0051461 , h max 0.628678
     area =  4.71976 , M area = 23.5988 , M area/( |Khat| nt) 0.307904
     infiny-regularity:  min 0.00348737  max 1.43639
     anisomax  288.043, beta max = 78.4404 min  0.792351
  --  mesh:  Nb of Triangles =    177, Nb of Vertices 116
Mesh adaptation done
Iteration 15 ----------------------------------------
  -- Solve : 
          min -0.00446603  max 0.126986
Compliance :0.862642-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.46908  max 4.96264
We increase the step size
Mesh moved
Actual Step 0.0103906------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2109 , h  min 0.00189563 , h max 0.290076
     area =  4.9418 , M area = 934.021 , M area/( |Khat| nt) 1.02277
     infiny-regularity:  min 0.135905  max 5.62417
     anisomax  21.6932, beta max = 1.76874 min  0.623445
  --  mesh:  Nb of Triangles =   2109, Nb of Vertices 1155
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 179 , h  min 0.00506924 , h max 0.654247
     area =  4.92842 , M area = 25.3982 , M area/( |Khat| nt) 0.32768
     infiny-regularity:  min 0.00338735  max 2.06817
     anisomax  296.656, beta max = 78.7865 min  0.771503
  --  mesh:  Nb of Triangles =    179, Nb of Vertices 117
Mesh adaptation done
Iteration 16 ----------------------------------------
  -- Solve : 
          min -0.00433489  max 0.127727
Compliance :0.831741-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.31079  max 5.16503
We increase the step size
Mesh moved
Actual Step 0.0138541------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2090 , h  min 0.00409091 , h max 0.246467
     area =  5.22403 , M area = 918.579 , M area/( |Khat| nt) 1.01501
     infiny-regularity:  min 0.0619355  max 4.80561
     anisomax  39.8752, beta max = 1.89256 min  0.640559
  --  mesh:  Nb of Triangles =   2090, Nb of Vertices 1144
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 174 , h  min 0.00499512 , h max 0.668161
     area =  5.21145 , M area = 26.2663 , M area/( |Khat| nt) 0.348617
     infiny-regularity:  min 0.003295  max 1.5814
     anisomax  305.097, beta max = 79.0898 min  0.760428
  --  mesh:  Nb of Triangles =    174, Nb of Vertices 115
Mesh adaptation done
Iteration 17 ----------------------------------------
  -- Solve : 
          min -0.0043615  max 0.128266
Compliance :0.863819-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.27122  max 5.30036
We increase the step size
Mesh moved
Actual Step 0.0184721------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2065 , h  min 0.00223341 , h max 0.311714
     area =  5.61763 , M area = 920.362 , M area/( |Khat| nt) 1.02929
     infiny-regularity:  min 0.0778664  max 4.20804
     anisomax  14.7266, beta max = 1.78557 min  0.714508
  --  mesh:  Nb of Triangles =   2065, Nb of Vertices 1132
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 186 , h  min 0.0049167 , h max 0.692426
     area =  5.60668 , M area = 28.0334 , M area/( |Khat| nt) 0.348066
     infiny-regularity:  min 0.00321811  max 1.75815
     anisomax  312.515, beta max = 79.2602 min  0.783743
  --  mesh:  Nb of Triangles =    186, Nb of Vertices 122
Mesh adaptation done
Iteration 18 ----------------------------------------
  -- Solve : 
          min -0.00399284  max 0.130993
Compliance :0.86785-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.10067  max 5.57609
We increase the step size
Mesh moved
Actual Step 0.0246295------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2044 , h  min 0.00191397 , h max 0.318954
     area =  6.14604 , M area = 902.807 , M area/( |Khat| nt) 1.02003
     infiny-regularity:  min 0.127189  max 5.27583
     anisomax  47.5761, beta max = 2.23813 min  0.671038
  --  mesh:  Nb of Triangles =   2044, Nb of Vertices 1122
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 185 , h  min 0.00492218 , h max 0.653949
     area =  6.13495 , M area = 30.6747 , M area/( |Khat| nt) 0.38292
     infiny-regularity:  min 0.00335773  max 1.5046
     anisomax  299.512, beta max = 76.1108 min  0.735007
  --  mesh:  Nb of Triangles =    185, Nb of Vertices 122
Mesh adaptation done
Iteration 19 ----------------------------------------
  -- Solve : 
          min -0.00415498  max 0.130835
Compliance :0.852618-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.21947  max 4.90765
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.00820983------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2143 , h  min 0.00189219 , h max 0.288041
     area =  6.35764 , M area = 952.39 , M area/( |Khat| nt) 1.02634
     infiny-regularity:  min 0.153328  max 6.64008
     anisomax  12.3657, beta max = 1.99577 min  0.591125
  --  mesh:  Nb of Triangles =   2143, Nb of Vertices 1175
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 189 , h  min 0.00483809 , h max 0.659404
     area =  6.34685 , M area = 31.7342 , M area/( |Khat| nt) 0.387762
     infiny-regularity:  min 0.00320289  max 1.57376
     anisomax  314.137, beta max = 77.6224 min  0.716278
  --  mesh:  Nb of Triangles =    189, Nb of Vertices 124
Mesh adaptation done
Iteration 20 ----------------------------------------
  -- Solve : 
          min -0.00380786  max 0.127101
Compliance :0.850215-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.29939  max 5.70587
We increase the step size
Mesh moved
Actual Step 0.0109464------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2065 , h  min 0.00193675 , h max 0.336832
     area =  6.60295 , M area = 924.098 , M area/( |Khat| nt) 1.03347
     infiny-regularity:  min 0.0370951  max 5.11611
     anisomax  44.0974, beta max = 2.39091 min  0.581088
  --  mesh:  Nb of Triangles =   2065, Nb of Vertices 1132
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 197 , h  min 0.00486746 , h max 0.637317
     area =  6.59202 , M area = 32.9601 , M area/( |Khat| nt) 0.386386
     infiny-regularity:  min 0.00330489  max 1.51615
     anisomax  304.398, beta max = 75.8936 min  0.768187
  --  mesh:  Nb of Triangles =    197, Nb of Vertices 129
Mesh adaptation done
Iteration 21 ----------------------------------------
  -- Solve : 
          min -0.00396535  max 0.130998
Compliance :0.847064-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.39094  max 5.55498
We increase the step size
Mesh moved
Actual Step 0.0145953------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2125 , h  min 0.00484495 , h max 0.323732
     area =  6.94767 , M area = 945.117 , M area/( |Khat| nt) 1.02713
     infiny-regularity:  min 0.08848  max 5.47014
     anisomax  19.3582, beta max = 1.94302 min  0.751478
  --  mesh:  Nb of Triangles =   2125, Nb of Vertices 1164
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 199 , h  min 0.00484495 , h max 0.682516
     area =  6.94174 , M area = 34.7087 , M area/( |Khat| nt) 0.402796
     infiny-regularity:  min 0.00329351  max 1.62242
     anisomax  305.495, beta max = 75.8521 min  0.754041
  --  mesh:  Nb of Triangles =    199, Nb of Vertices 130
Mesh adaptation done
Iteration 22 ----------------------------------------
  -- Solve : 
          min -0.00376861  max 0.126353
Compliance :0.859055-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.50818  max 5.3355
We increase the step size
Mesh moved
Actual Step 0.0194603------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2174 , h  min 0.00220374 , h max 0.327646
     area =  7.46998 , M area = 969.87 , M area/( |Khat| nt) 1.03028
     infiny-regularity:  min 0.0451113  max 4.3929
     anisomax  46.188, beta max = 2.06925 min  0.714168
  --  mesh:  Nb of Triangles =   2174, Nb of Vertices 1193
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 206 , h  min 0.00476702 , h max 0.661961
     area =  7.46344 , M area = 37.3172 , M area/( |Khat| nt) 0.418351
     infiny-regularity:  min 0.00316778  max 1.51332
     anisomax  317.767, beta max = 75.7574 min  0.76365
  --  mesh:  Nb of Triangles =    206, Nb of Vertices 134
Mesh adaptation done
Iteration 23 ----------------------------------------
  -- Solve : 
          min -0.00358042  max 0.125593
Compliance :0.843304-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.68457  max 5.66359
We increase the step size
Mesh moved
Actual Step 0.0259471------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2075 , h  min 0.00292058 , h max 0.361332
     area =  8.13265 , M area = 925.183 , M area/( |Khat| nt) 1.0297
     infiny-regularity:  min 0.0672941  max 3.82752
     anisomax  15.2883, beta max = 1.94019 min  0.74799
  --  mesh:  Nb of Triangles =   2075, Nb of Vertices 1141
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 218 , h  min 0.0048324 , h max 0.662807
     area =  8.12888 , M area = 40.6444 , M area/( |Khat| nt) 0.43057
     infiny-regularity:  min 0.00333482  max 1.58785
     anisomax  301.799, beta max = 72.6534 min  0.788607
  --  mesh:  Nb of Triangles =    218, Nb of Vertices 140
Mesh adaptation done
Iteration 24 ----------------------------------------
  -- Solve : 
          min -0.00352834  max 0.129857
Compliance :0.849397-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.91841  max 5.44389
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0172981------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2209 , h  min 0.00204445 , h max 0.329426
     area =  8.63971 , M area = 971.641 , M area/( |Khat| nt) 1.0158
     infiny-regularity:  min 0.0969768  max 10.3332
     anisomax  18.5945, beta max = 2.76734 min  0.452893
  --  mesh:  Nb of Triangles =   2209, Nb of Vertices 1212
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 216 , h  min 0.00474511 , h max 0.665347
     area =  8.63384 , M area = 43.1952 , M area/( |Khat| nt) 0.461829
     infiny-regularity:  min 0.00317131  max 1.58537
     anisomax  317.494, beta max = 74.4813 min  0.790173
  --  mesh:  Nb of Triangles =    216, Nb of Vertices 139
Mesh adaptation done
Iteration 25 ----------------------------------------
  -- Solve : 
          min -0.0034917  max 0.126892
Compliance :0.847171-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.06583  max 5.6097
We increase the step size
Mesh moved
Actual Step 0.0230641------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2181 , h  min 0.00278178 , h max 0.386899
     area =  9.28002 , M area = 952.595 , M area/( |Khat| nt) 1.00868
     infiny-regularity:  min 0.0833993  max 3.68888
     anisomax  16.0405, beta max = 2.91606 min  0.718497
  --  mesh:  Nb of Triangles =   2181, Nb of Vertices 1197
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 230 , h  min 0.00482474 , h max 0.661548
     area =  9.27705 , M area = 46.4058 , M area/( |Khat| nt) 0.465955
     infiny-regularity:  min 0.00334379  max 1.70117
     anisomax  301.087, beta max = 72.2554 min  0.819843
  --  mesh:  Nb of Triangles =    230, Nb of Vertices 147
Mesh adaptation done
Iteration 26 ----------------------------------------
  -- Solve : 
          min -0.00341341  max 0.126803
Compliance :0.858094-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.26724  max 5.53422
We increase the step size
Mesh moved
Actual Step 0.0307521------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2166 , h  min 0.00267192 , h max 0.425608
     area =  10.1903 , M area = 949.366 , M area/( |Khat| nt) 1.01222
     infiny-regularity:  min 0.0717363  max 3.90586
     anisomax  33.228, beta max = 3.72184 min  0.634508
  --  mesh:  Nb of Triangles =   2166, Nb of Vertices 1188
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 241 , h  min 0.00485024 , h max 0.718409
     area =  10.1935 , M area = 51.0971 , M area/( |Khat| nt) 0.489642
     infiny-regularity:  min 0.00339301  max 1.68014
     anisomax  296.767, beta max = 70.7579 min  0.716494
  --  mesh:  Nb of Triangles =    241, Nb of Vertices 154
Mesh adaptation done
Iteration 27 ----------------------------------------
  -- Solve : 
          min -0.0033724  max 0.130952
Compliance :0.864208-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.52778  max 5.40084
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0205014------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2328 , h  min 0.00244259 , h max 0.393448
     area =  10.888 , M area = 1015.54 , M area/( |Khat| nt) 1.00742
     infiny-regularity:  min 0.0930966  max 23.9794
     anisomax  18.3735, beta max = 2.40298 min  0.320098
  --  mesh:  Nb of Triangles =   2328, Nb of Vertices 1276
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 256 , h  min 0.0047643 , h max 0.668013
     area =  10.8874 , M area = 54.8022 , M area/( |Khat| nt) 0.494376
     infiny-regularity:  min 0.00322389  max 1.63912
     anisomax  312.485, beta max = 73.3009 min  0.744831
  --  mesh:  Nb of Triangles =    256, Nb of Vertices 163
Mesh adaptation done
Iteration 28 ----------------------------------------
  -- Solve : 
          min -0.00329808  max 0.127445
Compliance :0.850239-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.68035  max 5.45626
We increase the step size
Mesh moved
Actual Step 0.0273352------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2264 , h  min 0.0024668 , h max 0.54324
     area =  11.7907 , M area = 979.712 , M area/( |Khat| nt) 0.999358
     infiny-regularity:  min 0.116381  max 3.92928
     anisomax  40.0403, beta max = 3.64681 min  0.713365
  --  mesh:  Nb of Triangles =   2264, Nb of Vertices 1239
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 257 , h  min 0.00482928 , h max 0.687052
     area =  11.7881 , M area = 58.9404 , M area/( |Khat| nt) 0.529638
     infiny-regularity:  min 0.0033724  max 1.64942
     anisomax  298.684, beta max = 71.4159 min  0.762588
  --  mesh:  Nb of Triangles =    257, Nb of Vertices 164
Mesh adaptation done
Iteration 29 ----------------------------------------
  -- Solve : 
          min -0.00321216  max 0.138082
Compliance :0.84355-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.84809  max 5.3005
We increase the step size
Mesh moved
Actual Step 0.036447------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2340 , h  min 0.00229149 , h max 0.499368
     area =  13.1666 , M area = 1005.17 , M area/( |Khat| nt) 0.992028
     infiny-regularity:  min 0.0440316  max 6.74765
     anisomax  44.1494, beta max = 2.4417 min  0.67315
  --  mesh:  Nb of Triangles =   2340, Nb of Vertices 1279
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 278 , h  min 0.00477085 , h max 0.669843
     area =  13.1634 , M area = 66.0389 , M area/( |Khat| nt) 0.548599
     infiny-regularity:  min 0.00327268  max 1.68238
     anisomax  307.91, beta max = 71.6935 min  0.778605
  --  mesh:  Nb of Triangles =    278, Nb of Vertices 175
Mesh adaptation done
Iteration 30 ----------------------------------------
  -- Solve : 
          min -0.00292987  max 0.133627
Compliance :0.82946-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.03054  max 5.32367
We increase the step size
Mesh moved
Actual Step 0.048596------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2226 , h  min 0.00482348 , h max 0.558272
     area =  15.054 , M area = 965.161 , M area/( |Khat| nt) 1.00132
     infiny-regularity:  min 0.0840652  max 4.68379
     anisomax  17.4582, beta max = 2.44619 min  0.517946
  --  mesh:  Nb of Triangles =   2226, Nb of Vertices 1219
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 299 , h  min 0.00482348 , h max 0.710142
     area =  15.0513 , M area = 75.2566 , M area/( |Khat| nt) 0.581263
     infiny-regularity:  min 0.00341191  max 1.62732
     anisomax  295.265, beta max = 69.4323 min  0.683233
  --  mesh:  Nb of Triangles =    299, Nb of Vertices 187
Mesh adaptation done
Iteration 31 ----------------------------------------
  -- Solve : 
          min -0.00312247  max 0.127466
Compliance :0.862353-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.23171  max 5.22254
We increase the step size
Mesh moved
Actual Step 0.0647946------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2314 , h  min 0.00249288 , h max 0.779364
     area =  17.9863 , M area = 1009.73 , M area/( |Khat| nt) 1.00773
     infiny-regularity:  min 0.0587325  max 3.17967
     anisomax  30.4441, beta max = 2.89329 min  0.670225
  --  mesh:  Nb of Triangles =   2314, Nb of Vertices 1267
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 336 , h  min 0.00480575 , h max 0.67895
     area =  17.9872 , M area = 90.0239 , M area/( |Khat| nt) 0.618754
     infiny-regularity:  min 0.00343646  max 1.60625
     anisomax  293.118, beta max = 67.9885 min  0.76147
  --  mesh:  Nb of Triangles =    336, Nb of Vertices 207
Mesh adaptation done
Iteration 32 ----------------------------------------
  -- Solve : 
          min -0.00322469  max 0.128134
Compliance :0.852611-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.36136  max 5.37799
We increase the step size
Mesh moved
Actual Step 0.0863929------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2409 , h  min 0.00483041 , h max 0.662302
     area =  22.4892 , M area = 1049.04 , M area/( |Khat| nt) 1.00567
     infiny-regularity:  min 0.0570991  max 3.55928
     anisomax  20.763, beta max = 3.36472 min  0.644596
  --  mesh:  Nb of Triangles =   2409, Nb of Vertices 1317
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 383 , h  min 0.00483041 , h max 0.747439
     area =  22.4942 , M area = 112.479 , M area/( |Khat| nt) 0.678222
     infiny-regularity:  min 0.00352513  max 1.73766
     anisomax  285.711, beta max = 66.2056 min  0.696947
  --  mesh:  Nb of Triangles =    383, Nb of Vertices 233
Mesh adaptation done
Iteration 33 ----------------------------------------
  -- Solve : 
          min -0.00332571  max 0.130894
Compliance :0.870654-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.37451  max 5.43055
We increase the step size
 problem reversed triangle  => actualstep= actualstep/2. 
 problem reversed triangle  => actualstep= actualstep/2. 
Mesh moved
Actual Step 0.0287976------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2582 , h  min 0.00251553 , h max 0.739863
     area =  24.1754 , M area = 1126.72 , M area/( |Khat| nt) 1.00776
     infiny-regularity:  min 0.092113  max 5.7465
     anisomax  19.9683, beta max = 3.18751 min  0.70144
  --  mesh:  Nb of Triangles =   2582, Nb of Vertices 1410
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 411 , h  min 0.00476525 , h max 0.700035
     area =  24.1746 , M area = 120.945 , M area/( |Khat| nt) 0.679585
     infiny-regularity:  min 0.0034165  max 1.61195
     anisomax  294.861, beta max = 67.8602 min  0.705896
  --  mesh:  Nb of Triangles =    411, Nb of Vertices 249
Mesh adaptation done
Iteration 34 ----------------------------------------
  -- Solve : 
          min -0.00347249  max 0.130029
Compliance :0.844918-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.25406  max 5.3166
We increase the step size
Mesh moved
Actual Step 0.0383968------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2644 , h  min 0.00130288 , h max 0.663685
     area =  26.4917 , M area = 1132.23 , M area/( |Khat| nt) 0.988943
     infiny-regularity:  min 0.0911578  max 3.87094
     anisomax  18.7473, beta max = 3.81199 min  0.718452
  --  mesh:  Nb of Triangles =   2644, Nb of Vertices 1440
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 433 , h  min 0.00475956 , h max 0.717783
     area =  26.4891 , M area = 132.445 , M area/( |Khat| nt) 0.706396
     infiny-regularity:  min 0.00341844  max 1.65494
     anisomax  294.696, beta max = 67.5573 min  0.699672
  --  mesh:  Nb of Triangles =    433, Nb of Vertices 261
Mesh adaptation done
Iteration 35 ----------------------------------------
  -- Solve : 
          min -0.00304466  max 0.13101
Compliance :0.842723-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -5.14101  max 5.21208
We increase the step size
Mesh moved
Actual Step 0.0511958------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2675 , h  min 0.0024035 , h max 0.774396
     area =  29.7448 , M area = 1158.52 , M area/( |Khat| nt) 1.00019
     infiny-regularity:  min 0.0927203  max 6.16827
     anisomax  17.6411, beta max = 3.80361 min  0.741943
  --  mesh:  Nb of Triangles =   2675, Nb of Vertices 1456
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 470 , h  min 0.00474868 , h max 0.683911
     area =  29.7498 , M area = 148.796 , M area/( |Khat| nt) 0.731128
     infiny-regularity:  min 0.00341149  max 1.59382
     anisomax  295.307, beta max = 67.2987 min  0.718673
  --  mesh:  Nb of Triangles =    470, Nb of Vertices 280
Mesh adaptation done
Iteration 36 ----------------------------------------
  -- Solve : 
          min -0.00302815  max 0.128943
Compliance :0.852835-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.99824  max 5.07768
We increase the step size
Mesh moved
Actual Step 0.068261------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2741 , h  min 0.00293452 , h max 0.756125
     area =  34.396 , M area = 1179.33 , M area/( |Khat| nt) 0.993632
     infiny-regularity:  min 0.022066  max 7.05746
     anisomax  52.2921, beta max = 4.43635 min  0.753528
  --  mesh:  Nb of Triangles =   2741, Nb of Vertices 1491
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 523 , h  min 0.00473032 , h max 0.792946
     area =  34.4001 , M area = 172.049 , M area/( |Khat| nt) 0.759715
     infiny-regularity:  min 0.00339078  max 1.84129
     anisomax  297.129, beta max = 67.146 min  0.609136
  --  mesh:  Nb of Triangles =    523, Nb of Vertices 309
Mesh adaptation done
Iteration 37 ----------------------------------------
  -- Solve : 
          min -0.00310946  max 0.131275
Compliance :0.851466-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.78592  max 4.87102
We increase the step size
Mesh moved
Actual Step 0.0910147------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2759 , h  min 0.00169257 , h max 0.823113
     area =  41.0522 , M area = 1209.5 , M area/( |Khat| nt) 1.01241
     infiny-regularity:  min 0.0759413  max 2.90104
     anisomax  18.0055, beta max = 4.97519 min  0.720429
  --  mesh:  Nb of Triangles =   2759, Nb of Vertices 1501
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 589 , h  min 0.00470551 , h max 0.701267
     area =  41.0739 , M area = 205.428 , M area/( |Khat| nt) 0.805458
     infiny-regularity:  min 0.0033559  max 1.69114
     anisomax  300.246, beta max = 67.178 min  0.683341
  --  mesh:  Nb of Triangles =    589, Nb of Vertices 344
Mesh adaptation done
Iteration 38 ----------------------------------------
  -- Solve : 
          min -0.0030127  max 0.132733
Compliance :0.862993-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -4.46276  max 4.54682
We increase the step size
Mesh moved
Actual Step 0.121353------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 2935 , h  min 0.00240973 , h max 0.952339
     area =  50.5508 , M area = 1259.22 , M area/( |Khat| nt) 0.990818
     infiny-regularity:  min 0.0786557  max 4.14303
     anisomax  13.9153, beta max = 4.46162 min  0.732875
  --  mesh:  Nb of Triangles =   2935, Nb of Vertices 1594
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 702 , h  min 0.00467039 , h max 0.734223
     area =  50.566 , M area = 252.856 , M area/( |Khat| nt) 0.831831
     infiny-regularity:  min 0.00329778  max 1.82563
     anisomax  305.579, beta max = 67.4327 min  0.730848
  --  mesh:  Nb of Triangles =    702, Nb of Vertices 405
Mesh adaptation done
Iteration 39 ----------------------------------------
  -- Solve : 
          min -0.00347877  max 0.126746
Compliance :0.837445-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.97919  max 4.0523
We increase the step size
Mesh moved
Actual Step 0.161804------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 3076 , h  min 0.00311066 , h max 1.02224
     area =  63.6605 , M area = 1342.26 , M area/( |Khat| nt) 1.00774
     infiny-regularity:  min 0.0320941  max 6.17272
     anisomax  54.4851, beta max = 4.71391 min  0.679947
  --  mesh:  Nb of Triangles =   3076, Nb of Vertices 1671
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 870 , h  min 0.00463141 , h max 0.706641
     area =  63.6665 , M area = 318.847 , M area/( |Khat| nt) 0.846374
     infiny-regularity:  min 0.00322506  max 2.26409
     anisomax  312.521, beta max = 67.8431 min  0.707629
  --  mesh:  Nb of Triangles =    870, Nb of Vertices 495
Mesh adaptation done
Iteration 40 ----------------------------------------
  -- Solve : 
          min -0.00295779  max 0.129997
Compliance :0.854503-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -3.27014  max 3.32421
We increase the step size
Mesh moved
Actual Step 0.215739------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 3045 , h  min 0.00268953 , h max 1.37418
     area =  79.8868 , M area = 1333.07 , M area/( |Khat| nt) 1.01103
     infiny-regularity:  min 0.0334436  max 6.06473
     anisomax  15.718, beta max = 4.89915 min  0.708547
  --  mesh:  Nb of Triangles =   3045, Nb of Vertices 1662
Mesh adaptation of the coarse mesh Th
  number of required edges : 0
  -- adaptmesh Regulary:  Nb triangles 1063 , h  min 0.00460385 , h max 0.777831
     area =  79.8883 , M area = 399.442 , M area/( |Khat| nt) 0.8678
     infiny-regularity:  min 0.00317058  max 1.85912
     anisomax  317.935, beta max = 68.2629 min  0.679086
  --  mesh:  Nb of Triangles =   1063, Nb of Vertices 596
Mesh adaptation done
Iteration 41 ----------------------------------------
  -- Solve : 
          min -0.00294948  max 0.130107
Compliance :0.851551-------------------------------------
  number of required edges : 0
  -- Solve : 
          min -2.26377  max 2.3127
We increase the step size
Mesh moved
Actual Step 0.287651------------------------------------
Mesh adaptation of Sh
  number of required edges : 0
 We lost 1  other edges 131
 Fatal error in the mesh generator 1100
  current line = 373
Meshing error: Bamg
 number : 1100, 
Meshing error: Bamg
 number : 1100, 
 err code 5 ,  mpirank 0
